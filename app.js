// Initialize Supabase
// Replace with your actual Supabase URL and anon key
const supabaseUrl = 'https://hhokutlwywbrxyabzbjk.supabase.co';
const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhob2t1dGx3eXdicnh5YWJ6YmprIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE3NjI1MTIsImV4cCI6MjA3NzMzODUxMn0.T8GVvtD4Ej5scZaTboWxYu_I-IRdw8GAvD5L-eatvMM';
const { createClient } = supabase;
const supabaseClient = createClient(supabaseUrl, supabaseAnonKey);

// Categories and their mapping
const categories = {
    r: ['R1', 'R2'],
    i: ['I1', 'I2'],
    a: ['A1', 'A2'],
    s: ['S1', 'S2'],
    e: ['E1', 'E2'],
    c: ['C1', 'C2']
};

// Descriptions for categories
const descriptions = {
    r: "Les personnes r√©alistes aiment les activit√©s concr√®tes et pratiques. Elles pr√©f√®rent travailler avec leurs mains et r√©soudre des probl√®mes de mani√®re r√©elle. Elles sont souvent attir√©es par les m√©tiers manuels, la m√©canique, la construction ou l'agriculture.",
    i: "Les personnes investigatrices sont curieuses et aiment apprendre de nouvelles choses. Elles sont souvent int√©ress√©es par les sciences, les math√©matiques et la recherche. Elles aiment comprendre comment les choses fonctionnent.",
    a: "Les personnes artistiques sont cr√©atives et expressives. Elles aiment s'exprimer √† travers l'art, la musique, la litt√©rature ou le th√©√¢tre. Elles sont souvent sensibles et originales et aiment l‚Äôimprovisation.",
    s: "Social : Les personnes sociales aiment aider les autres et travailler en √©quipe. Elles sont souvent empathiques et √† l'√©coute. Elles sont attir√©es par les m√©tiers du soin, de l'√©ducation ou du service.",
    e: "Les personnes entrepreneuses sont dynamiques et aiment prendre des initiatives. Elles sont souvent ambitieuses et persuasives. Elles sont attir√©es par les m√©tiers de la vente, du management ou de la politique.",
    c: "Les personnes conventionnelles sont organis√©es et m√©thodiques. Elles aiment les t√¢ches bien d√©finies et les structures claires. Elles sont souvent dou√©es pour les chiffres et l'administration."
};

// Emojis for categories (using ASCII symbols for PDF compatibility)
const categoryEmojis = {
    r: "üî®",
    i: "üß™",
    a: "üé®",
    s: "ü§ù",
    e: "üíº",
    c: "üßÆ"
};

// ASCII symbols for PDF (since emojis don't render well in jsPDF)
const categorySymbolsPDF = {
    r: "R",
    i: "I",
    a: "A",
    s: "S",
    e: "E",
    c: "C"
};

// Global variables for PDF export
let currentPercentages = null;
let currentParticipantInfo = null;
let currentExcellentProfessions = null;

// Logo image in base64 format - replace with your converted logo
const LOGO_BASE64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAB4CAYAAABIFc8gAAAABGdBTUEAALGPC/xhBQAACklpQ0NQc1JHQiBJRUM2MTk2Ni0yLjEAAEiJnVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/stRzjPAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAJcEhZcwAACxMAAAsTAQCanBgAAFXuSURBVHic7Z13nGRllb+f972hcld1nunJOcEMOYMgCCjqroqrSDJgWBBXXVf9oZjWsLuuq2teBRUFVDCgLKuEUXIawgzDDJNz6Bwq1w3v+/vjVvd093SenoGRej4UPVV1U1Xd+73nnPec8wqtNRUqVKhwNCBf7gOoUKFChbFSEawKFSocNVQEq0KFCkcNFcGqUKHCUUNFsCpUqHDUYA73xtzrPsac6/+Z4r69MMxIootJXkf4lvVlLjAeo0XXT8pBaQQmPvt0Az4SgaYzXsvKXcfzf19pBF9jRV6W0c2LgRLw15dj5/1pzsc5u2knt17we0q+gaOMl/uQDhnDUAih+dP9p7G/uZZotPhyH9KIKF/iFizO/cQDzDhpF7n22Mt9SAG2DwUT849LoCcEYe/lPqIJU/u9nw14ftRYWE5aULvUZ+rZimK7eLmOfCnwF2D6y7L3ChVe5Rw1ggWgcpr4+XHMBhOdUy/HIbSW/z4LTHs5DqBChVczR49gCfC6fOwFYWLnxPDa/Zfz6BuoiFaFCkeco0ewACHAzyhirw2sLPXyWFm9NALPUHEPK1Q4YhxVgoUA1eVjLwgRPSeG//JaWQBTgFVULK0KFY4IR5dgQSBaGUWsN5aV0QglRnwcZqYQuIcVS6tChcPMUSlYfpeHPS9E/Pw4ulshNMM+pALLOewfs+IeVqhwBBg2D+sVjRDIjMY8O8LO5v0gNdIYWpQ8W1G/O0LD7iilqIc+fAZXr2idBOw5bHupUOFVzFEqWCBKGm1ocvUeylUY5tCCpQzNziUZhBY07I5QjB120XqWQLR2H7a9VKjwKuXoFCxAS8AFqyBQSmKooQVLaHBtzY5laYAjIVoNBIH4iqVVocIkc/TFsMaJFmA5AsOV7FiWpm1GgXDORBzeyp5KTKtChcPA37xgQT/RciTblqVpnZE/kqI147DupUKFVxGvCsGCsmi5AsuRbF+WqYhWhQpHIa8awYJAtExXYLmSHcsytB4Z97A3plURrQoVDpFXlWBBWbQcgekIdixLHynRqlhaFSpMAq86wYJeS0tiOrIsWkfEPWygIloVKhwSr0rBggPuoXlkY1oV0apQ4RB41QoW9I9piQMxrfwRE62Zh3UvFSr8DfKqFizojWn1cw+nH1FLqyJaFSqMg1e9YMFA93BH2T20i4e9R3o9wehhRbQqVBgjFcEq0ydaZfcwU+0eCdGqxLQqVBgHFcHqR697qIHWGfnALTz8k/PUExRMVyytChVGoSJYg9ACQgWDnjqHdK1DqGjAYe8BWHEPK1QYCxXBGgKhgrY0bU2F4IUjMwViJRBfocIoDCtYqlREyLHGcA6/CXKo6DE9BAqBEgKrYNJV79JV6xyJWFYvFfewQoURGLYfllmVXKI91wAcQAFe+a8u/1UGvuqiSucJ+5BTcWJKI1T5fb/fX3/w9gUaH4mDhc/4BUEKgfZ90iULpD3SohbamAbCL09h3f8zaNC9xxe8JsrHq3AwlN4yRbCiW2No8I+MLtcRWFonAzuHW0gpiWV6CMtFedYRObAKAxFCo1wD3zUQYkIzONURTGBSCySAMME1qYEikAU6CM6D9rEfGOBLcCTIl2WG9MPGsILV8Po3PVls3l81zDT1ysT3t+qZeoXYoC6Uj/gO1aqLpDLw+4tU78Pr93CBokLmbJyeGtHTYVDcDXqtR/Sxbp1ocbAZQuMG4LoKGY9yQW0HZHO44ShikO+mgZwy570m3PrShdEWHC20QvgCtEArgj6AvgAftBKghNAxAZ0acUoiVNqzK1HFN7a/lqJrETLHNeX3rQQTVFwwnpXK1HOg3fKQohW1HPakU3QWotTYJXpK4eHs3KuB/wa2cOAGMhjBgd9p8GZ63/MHvdf3uiU9obXA0wblbeh+ywzYZ/AbCV8HrwuCC7UN+BCQGeLYzge+CHQTnK8GgWcgy/+m/LrkgLFslB+HerVKoAm4Enhg8JvKlwhDYUcdfG9MN9064C3AhcAJwGzGFpbxgc3AE8D/AvcApWGX9gQkHHTCQfaE0SH/oG9CCXFjWPkfjxTyW81SQSHlSL/9eM6L3uPt/X17zwFvDOv6aK0REicSq+sJhZ8HPtp/w8MKlgrFoVTAlBo96HgMlGzRtbKWDLeHPkSHjvHu0veQwiWEM9wmB30iSRiHBtqZLptZIrayUOxksdz8uEn+5qyuvd3RVhEBFu5B67uOT0dVAx8/weWKl34PiSb0EOIq0CAd2t04eW0KCWbvUqp8+WhN32cMzC4xVYBVbRUwsBA6cBXHybPAtwhmi64f78ocsLSGFK2acIFnWqZx+8blfPjUv0AxwjDZrlOBJHDiBI5hRDQCKRQWCtN0KfkWBT+MHMbaUFoQsjSW9MiWTOSBr9QDPsnQgnUycOZkH/s4qRn8gpCabGuC+a/dSNOKPeQ7YyOtfybwWeDiCe7fABaXH+8BCsDPga8x1A3Nk+iqIu7xrVRvjRDOZkD200UhwCnNwTBSf1h8wol/nr2EmmJ+goc2eWghcKTBjHQXl61/moZM1zTGKlg9jo0jYqTIECPf57YJNDkidJPiDvsDpMRuLnPu5Vm1mKmi9SBxG47AJTR4hmPwlIGNR7Xo4XT5/BlvlivPuMB4/AfL5YZvbdWzvtBDrDB4u1JAopjhV43ncPHep6grtOPaSfrfSiQa08pybfO5/KD1TDDzYJTAcILhwN5t6t7/SfCilO1ohQl2AVbgEZfuKDbfQTSU/55EIDwTFa1VDOEeai2ojeS4bcNxXL5wLdXhAulSeAK7mDhRo0hXKcG/bn4HbV6Ka+f8iZNr1pN2EkMunwoVeGjfXKK2z8kNO+gpRBGi78sfzhp6RQZIfcfAijgsvng9QurA2jr4hjEP+AVw+iTvPgJ8sPy4BfgwgfsYIECkQ4Tm7mPj8QvItBxLNJruuzarnCJbUvX8z4ozmZpLk7VD5KwRwypHBIHGUJqnps7mB8efzc/vuUWfMmiZYQXrgdC7ecA/nS94H6FAiDrRhY+BRrBDT+dG8zucY9zNR5ybeFYt4Ri5Gf8QBh01ghIh/uifzx/98zndf87+J/OWT55pPPiRPWrB1ft1wx0lbSM4cPdOujk2xadz25Rz+adNP8GORA8+7YXmGLubmthu5llZmr0we/0IIdFPfgR4WhASLsvjLcSkF/gctodnhulmFp6WA/Y9DnYRCM4zBAI0XoZ0DzVQH8nzYkcDt25azvWnrUQXI0NdNIcNS/q4nslTnbN4pqeJtzQ8Co0lGEKwtBYQUewv5PnVmibuekM7tuHgKgMOuHBDccRGPMaKkJpMSxULzt/A9BN2kW5ODvW9fxT45kErKwmWizVtH15bDX46gegNNYh+2lz2FrRrYjU1IyyFu2cawjjotnk1cDnwD8Dv+171JNWym7+e4/Gh0geJR7uxVLCuY5goIXj/C4/xz0/dTyTTDXZool/H5OJ7YBh8/MLL+MBF7zJXD3p7WMHapxu52voe0+Ue3uP8Fy26jihFWnUNVxh381HrX7nJ/Si3+29mgdiOOsQMCYEmTJFZYi8+Bk+q43nSOZ73GneGv2D9169TRub1q9Ty9/To4GLQCHxh0Fjq5k9TT+XMvc8zPdNK1j5gmmtAl6p5b+olrq17DrTgP9pO5VPtp2BZmQG37oK2aZQl7ml8hFS4TYPWhAq0dE7hTbyPvDKJGWNzd4dgJwcsrYmIVh2Bi3ki/UVLCxqjWW7fuJzLF66h5ghbWRqBaXiEKdEk9tBot4M6+E6ttCBiumCH2NYND+/rYmN3gkXVLbjBCGz/eNRgXnETpfiOGVhXF61HK4lWYrBg3Qy8d6h1he2gSiF6fv12IvN3E5mzF12IIfrESgC6rFcakSiQWXkxSvlETn8KXQoxxAwqJvA74KvAZ4LNaDq8Bs6JPMnNa75Nbn8DVjwPGjJ2iAVdbZy5fR2FaBVtdVMx9IRuxpOOEoLqQo7/+vOtvO3tHznonBj2ZLjIuZmrjD/wLfsfuTfUwn3ea4mJHGByjfk/POlfxJe8f2aa2I+Jd8iC1YtGIFHMEnvJE+Hb3tW8qBfxa/v6d3/K/EHjFc4339Cpk1jCRSOIuwV0TYp3xN5B6wsbiddEUbp3W1DQJkutbs6LtPBvtatIyeFFRwMpo8SDmfnyq91LjWmRLMVMBICIHFfAfSgOVbRqGWRpaaAukufF9kZu27SC60974IhbWUpL8n6c2rhDfbQQjE4NeF8QsRxCUYObnmjgm2vrqQ21kHfdgXGV4QXrFZUrKIQm2xZn4es2MO2E3UNZVzcxjFgByFQXzvMnsPdT32POV79E9PSNlHalht2XPaWVfbd9kOzWRuY9dAa+V4P2hr1sbyA4LT4L4GgbK5zmTXolrJ4HNcVgKaXwLYuOZB1aCKRWRyjVcHSE1vSEo9S4Dks6mw/6oMN+8oViB7/w/o4iFv9hfp1rzDspECIpMqxTJ3K98xVsiiTJTCgtYTQUkghFlsotPKRO5vWln3FP6KrX/9j+1G2fcT59eQGbhMihhSDqtBGdKfntC3Vkiy4MmKNQ83RuBk/np/Ol1DosOUokSno8Xmjk/s4VkmhPOYYFllDjjWENRa9oPUsgQOPloEC81oKGspV1xaI1VIcLI40YTioaQdG1OWf2apRpgDbQauC5YEqPUNTie6tSfOrpGKlIlKiRwBKZwe77cML0ihIs5UussMvcczYDDLauPgq8b+QtBLFTAxCyhFKgh7FuNBqlNdLKY0hnrPHhzwBrgV9LFH4uTMsxCnOTBbkYhAbeeMXQWQAvK0JrkAbuELMjD5+HhcdiuZW/+qfxGnUrUYr4SEx8unQSDUwTLXiHMcTQ+wMtEdtYrRfzTuf7/DZ0+bs+Yt286hn/uG9Vi240AlHU1DcpOmbN5cGX6kgmB474Zs0ccelhCIUabUJCLYkbJbB7dMxOE3YNoCqIwUzOfai/pTVR0eqdrHVHbyxrXXsjt25YwfWnrxxpxHByUSqYdbt2HlHDwVDOgO9Xa4gnfB7cmuLGZ2qYVVuH9JqJiBIxOwIq239rR4VgOXmb5Iwuqmd2UuiK9herxQwVszqIYJR/7DcUEZReSG88ww//DfwfkKFkopNF9JQscl0DOnSwp+ALScIpEnGLIF7Gr1srcnaEgmlBkHs0dsHSCASaOtFFEZs8YQQaB4uQKJHXUTbrWYQpUS86sXEP2S2UKDLE6NApKO9fIUiQY77YycPqZL7k3MDn7Bv/fZ1a8rvH1Ym7UiKN1jBV+tROScBLvTmgr8jBpV52EAjOKibuHvaOHu7otbJu27iCyxe9cMRiWRKHrGtjzL+EadEtiBeLA1JLbMMHN8aPXqpB2FNImIp96Szz6yVTogauJwdubmheUUF3N2dTPaOLaE2OQle0/1uffbmOaQgagU/TG88yFbo2P+z9Nuy7dEYS7KhvoISDcRhnGR6K3sOKYjM1X6C62HcjG7tgBRsKDjzcL7dqn27gncY9fNT8Kfers1jpn87D6mQ8TKaLZgQH522NRu86u3QTjaKD9xm/YbncAMAmPYcn1XGsVkuQ+PyPfzlv9e+3zzOe+GwXVR+oFmk0UO35nFtvcW90LiXfIGS8MoKII7CDA6OHE7W0VgEna9jRO2J428Zjuf6MIxTLkh45VUU45JEwOlB64PkVMX32pTVbMylS4TjK2URHaQqnNO4hEsuQSQ/I0B8uXf8Vc+cRQuN7BqkZXVgRl3xn36EtIBipO1TyBNfviEldY+RDwH8CXfgyECxTHXQvl1pTlc/ynyefxy3Lz2VxT4aXJ6Il2JSM8eUHf8uVqx+FIM3ioHNiWMHqzRrv0klKWBiocuqBTYuupUPXcKn8M1eYP2GTfxI3eh/jr+pUf7poVnFyol9cSxAo5Ygn3m49lbPlM9xk/T8iopP9ei4azVvFvUCRp9WpfNe7kl/4b+UT7v/jz6Er3n25+Ycvd+vELgNFwiuxNBXjW8npbO1MEDKGTwQeI0fiQtnBobuHzwAnKS12NEaz/OKlE7h8yWpqqrro7qlBSrUHaCbIdB8reYJ6xsW9LxjCx5I+pvBRSFxlgu+gwimMUJhiwUMIuoDnAJvy92dKFyljZLOCqkiBedUR3jirBF4RTQggRGBF5ZQShEMuhuGXXXBgYn54N4Hb3HccE0QSJN62QRAvFEKTmJJGDRxceNMh7CNDkAD6O2AvwfE2EWT4fxKYNcHt1gBXAN8RJQNdU0DHHSiYEPVAswnYL7XeimGwuirEBzpn8JkdFpnhK71yBOfEeI9pP0FcLTrUm6GyiF68YDdFle5N70gC+wYvO6JgpXWCmWIfjaIdFxOJolOn+IN/Abf4b+E4uYFz5Co+Y36HX4feyu3eddd+yb3uR74wplSRQQUJmL1lFBbBnSNJ8IO8BrhSopK7dRMnyvXcFrqcDeokPlr6IXtoxMSjji7Ok09xvXULPw+9i3d7l3K1+x/c4r3Dusr8wz/sYep/mvgUvSh14RKzo1m2ttRA+JAF60g58zsI0hVWMbHk0lrgGQ0n1UdyO3Zkqrnmvku58423karqpjudulVKdetYNqS0JGrlsc0iKOPtWMU7sArBMLoTwy0l6HCSRI0SsXAGrN242sKOCsyCQ9LOPG3a2YsTSpN1IigtsaTGEuD6Bj6ahnCO6pA9sFCDQJWi4RI96Thd3Qlsu6+6YSIu4dPARRNYb1iE1KT3J5m6fC8zT9lBvmOAEfS6cW4NDZgNHTtD07af5HVUtw/Ix4KN+HKjTOS+bzft/pURz71jhJHBkXgz8B2KJrohhzphP8Z989BRD+Dfyg8UYGqfhpKGIiRGdk5uAL4yzuP4LXD9sO+WBSvsOoQ9d2A+2iCG/RZ266nMFM383P5n6uUO0CmC0h+DZ9SxfNu7it/7F7JBzeN//fP4jPl93m19qztGlhu9jzUXCWEPUVLTj99I9PXdVP3QQH3wv6wv0qNmc0np5xSxaBKtaGAfjXzXv4Jb/TfzTuNPfN76Ck/LN/KgOpe0jr2uidb/1AgMNCkjS1O0G/Tckfb7SqR/IH7CoqW0PGlWonvH/Xvm8rY/Xslv3/yLXtFCypHPQqUNqkI9tJeq2N0xj4Sd58WuWdy9+zS2ZqaSdiN4yiTnhZEo4lYBketixYkNvOeibrY2h1ndPo9logVXmDREO5DaRpdL+qQIoqIlJSn6+mC7RwvMsMOLT82hozNJbU1Pr5X1igi6+46BEJoV//As4WSB7l01iCDsYAHLx74l1ffZMytf8z6VD7VHlr+E1diG2xZsU/sG1pQ2VHcVXXe+9Z3FLQtmirA6fZi63pE4G2hE0CIyNur4fYjNNci9VehkMaiopTxuqcEV+oB5cSTpO4ggD2skm3pYwfKRfMy8mXrRwkecb5Alio3LArGLq4w7+XnoHfzRey+fcD9FDwn+zfsgf1LnMFW00UgHPQxdntGLhcduPYV2aj70HuO36TnyhX/5kPNDcoRZKLb3pUqE6KFWdJElynf9y/mTOodvWp/nMuMWHBqOt8lHwQgKoexWltfsBnXqMHsVY/IPxhuDmyR2cYiipeFZrcVJy2pat6/cN4u33X0Fd77xdlL1+yl211L0LOQwca1UKE1roYY3PfAFnm5fRG0oTcrO0xTrYFH1Ho5L7KaeDEk7Q8ky2e1Ws22vhRO/mNq4w4t+iAvv+wqxiCDjx/jhGd/hmhW/RpQax3TwsViBtpYaNmyeRTyeP1SXcFLpta6WvnEtc87cRvfu6l6xgsBlbBrzxrREmiVMmV3fcttlK/3bLiO5aB2zf/TPmLWteJkodmMP+SdOYtfH/pVcexMaPl99+gP3TeC0DAHHAi2UTHSVgzp1D/K3y4KM+yOYrzdZDCtYL4beSFK+yA/cT/Bd7ypmiL0I4HdE+JH3D7zf/A2fsD7HErmOS0s3kSPMC2oxz7OMWtFNiNKwo4YCzTY9g7Pks7zLuJsz5TOf2qpOeOtj/gnzmkTrQXldCkmMAkvEVvbqRt7q/A//bX2Zs+Uz9d/xrl+cJv5cmBK1JcFK1wPRyoBbeFm0tT4Qmxv6uAA0/sv3O+7igHs4tit9IDXAKq3Fyctq2rY/sn8GF/3+am444XEumLOBcKKbUiZFYQjhcpVJ1o/ylZNupdrO4imDJdW7qKrZAa6FmxNk6w2yah6J5hKpxDZYvItfqVnsLBzDtNgq/nDBTSRimm63imo7C24cU4yevaa1wAw5rN8wh3Q6Sl1tT3/BOqx3D6002j9gfQpTIuTAu7xbtAgnCyy6aD1e0eqLZZUZ1yiv353CaGin6dbLN6pcDAS4rXX0tLeRSBSQwsQptJLPucTecQvVU5vB9u63F25ar7qrl07ANZwDgNSIrjBqThdqQQdycw06OUrY5HBfBxP4ZYf99L/3LyDvv4nf+BdzjNxIFdm+LPQsMb7oXsvT6jjuCL2Vm+yP8g7nZqIiQ4RSubHU0GKlEWSJcr58gq9Z/8kUsQMQ+k7vDb/ppupTs9g35PekEfgIpolm0iT4qnctKdJs0rOmSfRzAo30kxTV0yR4kiBUVl5XB26xKRRFPXxIxCt/g7FDz2o/FHYTjB5OVLRqNaxCi5MXVXds39Rdx9vuvZQLpm/nmiXP8/p56wlVdVNKDxSuvB+jKdrJ3OpdfSeq50VwW2ez3XPJnm5TN38Zme7NrN3osmjrPGq7YnRNnUldCIq+4KTYGuqTnSDC5N0I3Z1R2rKa5s4SWg4dmtBAPFagvWxdJRIDrCs4jGkNQgq8goOTKyFEcJ6EqiKYEbtPxITUZFsSLHvTWqYeu4+evanBo6/jqxp2LTA9QsetjghLoXUJU7VhdV9Awvl3DFPT2fkTxMm3UvMGC+nXoIWH6kl9XnVW/z2G38aB2sveR/92O4ID39lsgptggC/B0KhjW5Dbq0ENoxiCAzHGw3W76P0KTcYljMMK1me9j6EwaBRt1NCDW140sHbyHCdf4j7/NK4u/ZxbQu/kw+ZP+Ip3HbPE3gHbUQhsPEK4felyIRxM4XGj91H2l2sUO3T1s1NEG6PlUPkYJMhSJEQXVcwVe+r70i9ED7vJ0INF/ywkhUG1LIB0afbDfceVVRZh4RMRHiHh0+qH6PLDLLIyoA0j54dwyxfPEXYSd3PAPZyoaD3jKXnS9Hh6u9KCx5tn8Ne9sznvpeMD4Zq/nlAsQzpdAyJoE+MqE7eQ6tuIKRTpXIT00iJzj11CqO1pZhqPsexc2BQ6hr33zaRpaoiI8Ggu+ayKXUzT1ChOOXRpSKiOOZyfa+SHf/aYGlaIQSNQAjDiedY/dSzpTJS6mp7BgnVYUL7Cyzgse+dpHHvZaXhFFytq8+g3/sSW+9YRqw9CGn7eoHpmJ8v+7gWcvD3YuoL+XRLGglSgJH5b46na6kgppbur5A3EQ1eDqAHtUpP4DyLu8XRv/xG+7sGSMwHxGwz/N4f0oYVGOAZE3CCBVIshYonBn2fqfG5s2IepFbae3KCWJzRZCTe0T+H8DntcaZPDCtYscWBE0R20mEagESyTm7nLv4D/9a7mn8yfc7v/ZhxsogS90H0MUmSJUKKDagx8BJoQDk/5KygSwkDhYxAjvzMhsmMq81FIbFxsXPRBl8BABIBvc0K0C2SJF5wUICgqmxNC7WxzUqRVmCpZpMur4tFiPZdE91Fvd4qiASkJEJlYn4ZDYw/BHfIxgmZv46UGeEZpcRKwfVaim0C4prNyz2zOefFEPnnSI5w1cyeZXIKhbnOW8Mlql2JqGRQ6CLuPBfZECaobWlitlhFK1JO0S7ixqdQsbGTR1J1knGD0WmlIRjXfv7yDQnsLtzyT4IyZvZaWQGtBsrabXZtnsnb9XKoOtq4OH0qjfEX1vHpScw6EDKP1VbhFp6/fjetbxJIZojU5vKI5VG5bB72jUWNFC4i2Vavdcz6bilz3ieiMs6HUA2orwRkbJWJ/kJBxKt3ON8n7D2LoOqRMlgufJ+6raaERrhFYV4NzFTVB4kFuP917v8trduapVocnAblHOuSzEpIfhNr5lCVjVA6pEl6gqRU9/Mx/KxfJR/kf6/O06hpsXHwMaukiKor8q3ctO/R0UqSBQHASIkeCXP/NqQnWJBZHejMoeje4Ir4DVIj7C1NA+HypejXXJLZyX2EKH+k4kbQOdO+XuVm8KbGVB5tWErEddvak+CSXUNAm4ZFHPQ8HRQKTfiKCBeWYFnCy0mI7wKxED0oL/rp3Nms6pvDkZT9majxNOh8/KL7naoOEsOjs2Uuu1E2q1+GIQKa9lgZL88T+HNm6Rtq7Q8iOu4j0PIbjNfRto+iDnfD52Ts9osaZ3LZ6Cn7ZFUnWdrN31xTu/tOZaC0I2S5qODdlshGA1rjZgXEc5Xh9vqsAQlVF9r00jQ0PLOGUK56kfWs9YmDb4f0EqSnzxrxvqfEKOaz2t/xzdPHbPPznP432OHA5FkFtQhrzqQn9ADtzK1njZpToRuoaDkdwSWsgFoJcgdaNn+aM7i1cIOoPX2BeC0q6k9b4VhqW/TfUzhjTxzokW08jqBcdrFWLeFSdyInGI1xoPMrZxrNcaNzLieb9/K86n6fVCqqGsJw9zP4jcnMmeBh9pqAEPCQlbVAoP3q8GFPtLt6S3MCvMvPIleo5PbqHS+Lbadj2LmJGkU9Wr8XzYgijyB9z09lWqmFpZB9zwm0ssbsB8F+ekcP7gL8/xG3UEiRRzgX6av2OqW2jsxjhphePh3BhyPPS1ZJUvEjDToctLxo0y3qogo3rZqPXLWZGTZEZLd9i0cb309j6B6oTDiQNkgm/71Gd8jEEoATf/4cH+dRpW+jMhqEmzd5dU/j9/56DryTxeP7IidU4iabyvPD742nZOIV4fSZopj2QF8azPRHOoPYsJRo/C6Zu/BSO2gDytf2WACTovWi3k5h+H1NCd2K2/D2+ajvkzzMYLQS2nSSxdwM89E4aWtYSlQ2UO4cfngc+IVlLQ+ceeORdsG09wqodMQcLJqHXkIlPnjA7dRPoCC26jhrRBQg+4fw3P/EvZaHYTpA2eOBgLDzyREjrVDnnSp4xQS3vCypqIXCECVrg97Y19m2+0vgcCJcvdC4Ho8BLTjXbSrXcPe1eaoTPN3IzQZZISodup5pv9yzhW9G9OsjPf9lKfO5j3AmJw1LNgdrDbQC+FkyPp7lj4zFcveQFZia7DrKyBOBaHlNKBt6LSVpbj6fDUJj76pkXbmarrGVmoplja55kT8ul7HJm05hrJusdnNLiFQQ1kRLXntdOqSfPvpdmcde9Z6GUpCqRQ6lh752Tf4svn4ZOroSTG9huSFrGwD1qiFQV6NxZy1O3nMHFN9yDYfuogXWQ9xH0ah/j/l2ESmCEbVAOCBYBK4ENwNeB24Fi4GUW8eUOTJZj5I/Fqf0FoxZF9N59xuBey3IAybGquCOxkeZzTycXu5TA4jsCCBNZ2I8OPcVzybfwTiMBymc4aTpkwQqSNlXZt7eooYswPXzC/RI3+5eySGzDHCRWCkmWKO83fs0u3cS96qyaCKWrRko5GIYtwMbeJ7ucCO8Ob+Yt0/5Ma6wOH4HQcElqI9/sOJmNxUZSdhfdfpiPdpzIF2rW8O30Ih7NN1Ft5oKGdGaWn2fm4vM6GQuV6ErHAQiPYXh+ErmfiU1eMRJ97iFl0UqFiqztaODnLy3ns+f+GZGLHxT89JVE2YpZZhqnNYavJJFYC8pycQsGORXFU7Op0j30tFk8mzt1WInZrAXhsENYllj9yHF4JZNkdWYksYKJjRJOJeifnuxbvxxfdvIO+bYMTqZAfEqK1JyBWQle0UVI0Tvy9gegW/mS5LRutjy8kPUn7mDZJWtJ70v2/65+T1C3N8YaQAnSBeWCHhCCXUzQ/O/7wB3AjzHEI0ZYgO5Am92MeskqCYaPNWsnKhvHa68b2KXU9KHvucDyffKWzXk717GqcQarpx3b15n0SKGTtXh+lretuZsT2tt76wiHZBIEqze3SYDoJkyUT7hf4if+24YUq951OnWKc+WTJESO35Uu/Jkt3Bpz/B2n/tL7D4XA8+ENah0npjZCOIiXYRRoLjbyxc7jwQjCXdVmgf1+hPfsPx9plEiWxUoDCcOlpAy+23WsxNR9/bBs4U9GP6yx8ABBHdnhoIYD/bS2+VowI97DHRuP4ao+Kys24NcSAFpQEAZEg++vgCSqBVJoDKnI+xYhNCdEOrAsd8TEW8v0KZYs1hkKO+yMJlYwsbDFscCfApESeEWXXGsPTq5EcmYdS99+CssuPZnpZywAoGdXBzuf2MK+VdvZ9cQW4o1VvdtZTlCXGFQKCM3+9U0se8PawcLeAnyHoEPCZBACrsTgSj+jmp395u3R+eLnArFmtBVlVRpn00K6f/CPVF32S8LHP48qRPqsLR13MEp5VGw28S6JZXgUQiGufeoBDKc0uKnikUUr3GgVyrSQuTRqiFY3k9Z+NlyedeiT7uf4if82FortQ4oV9CaK+PRQVe/o0G8l6uwJRi/u6P1HUVo0eN005DPg11Nw4xhobA1f6DyOHjdBtd0VzJSjBRHpEinHp4IORZDxo2jfJGwWqLF7KJkQdk0muR/WSBxOseplgHuYCpVY11HPLS+t4MZz/1S2skb/nFoLDKGwDB+lJB3FBAvsZpLxHlAjnFaWR9IyCZkuaT1kLewhI4TAdz1ybRmcdIFYY5IFlxzHsrefwuzXLgWCtIbN965l/e+eZc9TW+nZ14VpmyRn1GKErAHJpL2fN1adp2NbPenmJHbUwckPsAQ+R9BXfeS6MCURlgOhwuhelwRd0lNy62o+Hl1c83FMbxPoHwM/ATqH/OyhEhguHbe/n54730XsjAfRvhlYXoDSFobns2ThT3n8+Bj/vvAyDOES8l7W3MM+XGngmCafefzPRN2DE1snTbDqRSfr/VPOvsV/a+s8sWt6P7HqLYA2CQbFYwTz9Z2kEa/REw/8ryLw+wEIW5JwupsP7VhMwVuMNA1kuW3N6lINESsz7J1fIUirEO+p2sjFkWb+pfM4dntRouYhF1CPh5XAa0ddanLocw99LbZN64tlrRkyljUUUmgcZaK0wNeSiPTIFS2ac42YI0zeaZg+vmfgKYk5ifFBIQW+41PoyFLszmEnIsw4fT4rrj6LeRcd27fcpj+vZd2dT7P76W1k9/cQToaJ1MSpX9wE6OA/f+jjsmMlOnbWsnfNDJa+fi2lXKh/moMLvJ1ggGNotEDEcnhdKbyNyxALCPKyhsPXWNVRCO2h55EMbtxdaMxxvk5OfB2h7wS+BLw4YB0lEZaHHW7HLdbR89AlB21WARtXrSA9+2Zek3uSWGvsFVOmI4CMFUKiiXgHj8pPaoN/hfxwnNyHFZLSCAnAGoFTHiE8hHGhr/Z/EgsLWne5rG2vg2iYAxkIgpgsEhZe30jf4H2m/RArQh28r2ojtdLl8zXP8779F6DHOMfiJPAX4LwjtbMyfe5hKlTa9mJHPT97aQWfe83QsazBSOGT88P4WuErSVSnWecs5SnvNFJG97DraV8gfE2EFkKiWC6OnhhCCJTvU+zOk2/LEKqKMOX4WSz++xNZ9vZTMMJBfGjn45tZ+8sn2fnYZtJ7OrHjYWJ1CRqWNaH7JgAY/YIVQoMW7Hh6Dotftx4p1eC8secIYo8HTboKICwXPxODvdOJNeWQtjeyNeoLsGsILXqcovguXvvJGLlZCNND+8bbCQTyQeA6YP3g1YP099zglwFNM3Uce+dS3pC7ETpnj/rZjyhKgWEyLdsDvH/AW5MmWKIcBSoRIodHCGfYu7SLRZ4oHgYTnDrrV8Bdfc+0RgtJtqUbW2cJmwf2K4UmryxybiwY8dMShCJu5rDKHU0t6bHbj7GuVM9ZoTaeLEwB4R2KmI6HvwLnHpldHUQ18IyvxWumx9Nrf7NxGe+av575Ne1kipFRVtW42kBKH6Ggrcdm2jF1fPi4DKXM8EJvhgVeUXPvUw5dnQ7hqhEEq1wv4xVdfMdDKYU0JGbIQnk+hc4cdixE3eKpnPqRC1l+xZnYiSDRsXXDfp67+SG2rlxPZl8Xhm0Rb6yifnETuteSUuOzKrQWxOsy7Fk9gz1rZjB9xS7SLQdNQrESWELwu04ZsIFQEf+lpSRmt+BlXbyeGCHhgq3BLY8K2BpyAsJl38PIoTMLMGcpQrVbyeych73kRSj0udPnAusIJlZ9P4zlLiuI4rN30yXYp68kNnUjXnfDmK0sX8o+t0mqYSbNLS8zUXwpqS4cLLaTIFgCH5MiJsuMR1gZuhoNtOhaUiJNNT14mJh4pInTrqtpEJ1IYLF8mlX+OSiM8Xy4LQyalSQUMtjRrdm+3QVZi+P2G3lRNg2hDv5fw+PMMvIIofl9bjo/Ty8hZBSICpe48Ej7Nl/oOpbpZo7nSrUkzbzhHf6Y1WSJVZHA3Z6Ie10NfCcZKp27uauWDZ31zJ+6J+gLPyJBiYopfaRyKBo1NM40SaV2DpoEZBARoAB2RCJDYcwREqm10ggpqJ5TT6w+gWFbOPki2eYepCmZesIc5l10LNNPC3I22ze3sPa/72XLvS/SsaUFwzSINVZRu7CsG5ohZwcfD4btU2oJ8dJ9S5l5ws6hrCwI0hOmATeh5HuE7SASWZQHVqJAaM5eum8/F3Oehnka9UICWZNGuwaqK4YxoxO9P47WFvL4IrwQobB1FrXn7CG3uxGiWWTIYVDawlXAm2R114UykX1mNBPZoECROK2r38iyNzyDLEZGD7hrjZIGXeEovpTYnktVMX9wH3ityIQiFEx7wtOHGUpRNK2Dhl0PWbAEmoTI8KB/BpZW+EhCOJxrPMlONZOX9HyiFCkQZrbYy7nycR7zTyFLjL3qjTyiTiIqCoxRj9sI4jx9ifxaa9rD1Vy6ZyXHm3+iZ+aBHBVVdjlPC7ez2U1wb2Eq1dLhi9Uvcna4nfe3nolp+phoEkaRTj/K/mIDyBI9vg1a4PbNcTnp4jVZYrWFIBP+34BrJ7B+F3B9TynEtHiaxTVtMJZ+8OXOF6ZUZLOCnugs6moEdJkHTfU1gHwJZIh33vGPEEmBN8LYq9ZBQaI18oW05+lt3PvpO9jy1xfRKJJ1NSRn1mLHQ4FATeJPp5WgqjHN9kcXsmvds8w86yW6185HGL3FPH0o4L2Y3n+pbOxburPmfKVAt0yhtNlHGUVK+zdR/PXxdO16jKpZi/CLBTK7NjDt9afS/cJmCs0ZGva+lmLH/+HrMIXN8/H2T4FdsxDaGCrPqlplEqv81vq3IPVdwUvDNSGACD5qzVl88apPsOvcDFVtI0+mWjBtUqU8//TMX5nW08YLU2bznXPfRkck2jf7jkaQcgr84/MPc1LLbjrDkzuwMimCVUc3/6dew6/8N5AnwlTaeEL+A7/w/44vedcxW+xll27iA8av+S/rq3za+wRr1SKSIkOMAnWieyyzRm8g6FLa2v9Fzwph5bOcu/MxXpNsoS3s9J03BpopZoHrO07kh+0nBWkN2uTfuo9h88zfc0PNar7acQLVVpouP0JSunx9yl9oMop0KJtoyKGtJ8EvOZ2iMkafImzsTJZY7SVo0pYhiGNUA5eNY/0u4CRD6G17slX8y8mPMX/aLjKddaO7B0LjawONpuCGaZoVwoiloVuOfHM3gsTMl57dQl6lsMTwlVXSkPiuT+eeTnIdWTzHwwyZxGsTTF86nWRdgkRNguknzOY9f/wYPbs72f7IRnY/u4P9a3bRvrEZaUriU5LYsckTL8P28YTLmtvOpt6qQtbsw3ckQfrWoGWr0i8Wd866oP3GLy1wd8/8qBHJX7m/lEz4pRDKKOL5cQwRBV0Dwge5kD1fqEfLRjyKbFW1GPItGPod7NdW4M6OGkbRv9eY52p4yGd4S1kAdRjsXXMRP7tyB9N3yhFrOduicVa07uVTT90HToldVdXcM28Z71q/imQp+B2zdohblp3K63Zs4OQ9WyAcndTQyqTEsDwMEuSIizwZYtTTiUYQEUXqRRc1oocCYWIij0JQK3qYIjqoFj0I9FjE6mbgmsEvaq2JJ0J0r97EpS8upJg6HXPQj6kR+MokEW4vJ7hCl5Pi0x0ncV1yPV81jiGnLdAm3659gtlGnjvyM1hqpfG0wJ3kSnWCGMe5k7CdPQT5VC39XnsXQSHuFWNYv5NyakNnKcKK2mauO/5hwCMRzgCaghvF8c1hm/4pIRAopGUwva4IQ3USHYxtQgkevOkv7N8H8fgoy5eDJdKQCCHQ5aLlpwXYIZt4bZypi5qYvnwG04+dxQkfOJcTAL/osnXlerY9uIEt960l29xDYmoKNcwI4ADKeS7+cNafFhgzN+Lc+S+0bzBo+t1FFDpiuKVg27K/iyQ0QniobHKz46auk27qIzUX3/Xmqtc9+m6vK34JZsnAiYMsBDE7FUZ5WYQIIUwDjCx4MVAWWmuEqWCknlhagFTIWPZWgkTUoaLufdTlXa6rj7Hv+VMxijbW4N7V/WiPxDihZU8wemfaeNJgcWcL//rQXURyaUDgRGI8M2UmvhAgJEoIYq6D7XtBN9FDZNKD7hJVTicI0v5NPAx8DHxkWUyCZQ48H4ENBPGqJ4Y8eNvEyRbZtK6FvBUHLXCGEL+4UcJElXOwQBg5tnsxOv0ItgbHSbEwup/pVpY377uQHi8KwgOTvsTRsJyUxNHJGg3cRSA2rUO8dyXBZX7lCOv3iZUAuoo271iwm2ojxsa904KMfzTz6jcS8kNk8jXIwT3CtMAwfEJWiVw+humFCeauGD0OAoKq+ipKmESj44txCCnwHA/f8TEsg2KmyPoH1/HCvWswTIOqhgSN86e2Hf+mEx5aeMmK0MJLVojCDW/kgRt/y/a/biBSHRtVVLWvbWlKM1adyDAo/U4oSSnVQSy9kNnMR9nPYRgGYSuCqcHzPXzlo3Q5IKEFSBChfLlZNH7VJSt/P+XD3/19qXVGnKBW9J0EPegnc9R+ukB/XiZynxS205eHNRjTKnJ8OsQb/nAjm9MLSYa7h91gdyjC4o7m8kSnwYzRvhB0JFI0GAYaEcS3hESWXcSQ77EtWUt7JEbIH3+u1+mDj3fcWzj8FIB7gB8RlKgMidYaMxGl57mNJNr2UVeTAD2wwLr3vEwrCxfZFyfTyqbRyHNBpJmb6p+gR1vMNzOssNLMtjtZo6HeLOBbipBnAqnJSBxdyeSI1U4Cy6p9hGWuIhgtGmoW4s7y+tsBBC6psMctOy7jh9s+gO8H3Qo6iwnOaNzIfZd8gmS8hZ5sA7LsEitlQCRLdVUzlpD0KJuINMD0IKaHbwwHwSiYIQKXcwJfp/Y1hmUghCDTnkH5CitsEUlEMEwDt+Tx4gNrn9+/Yd/b3/3f7yaajBKpjjHrzIVsumcN4eroqMk0WmmkIYnVBOZfb6BeKImT6sIu1TP7z+8K+tzZPSit0VphSAtTmvjKx1OBcGH4qLxNqa0eh0DO/ZZaSi0zcHbMzAK3lh9x4O8IbjSHPIGGMBRa8/7808d/xe9O9ojQ0IOHGkFIal7X3cIphX1YxvDfjSclMdehZJpEnIGzqw98HHg95jo81TSHx5rmUlcYX+swOAKCFVzWopykOaELfA1BfsmIGLaJkynQvmEPVsga8hQc7qs3DYdNXoL3t59CrXQw0Dxfquam7FwcLYORL3Q57XRSIrYPMDlJoTsILKORxKqXawhGD6/r91ozcApBg0AModncXcc1y9byj8t/y9aeFFJoLOlTZWf5hwc+z4l33MSGKy8jahUo+jZKmSSTe9jTOZ07t1/Ctef+mv3pOuyQg1+oYsO+BkLm8G14TAs8Fzw/mM5rvK0Ru1u6OeENJ3DBBy9g/44WNj2ykZYtzfS09VDoLuAUHayIxf4t+3nmj89wzpXnAFDKFECOcV9BNgWe65e70OiyWLUjMyFm3vVOwula0kD/Qiatg3NGSklIBjEz7VYjZvTQcPWvyK08l9yWY1Cl8FAfOwvcVn7UENxs/pmJNXAEoTCr06nOW//h0q4nX3OzPYJnWCLG/DN+zKKzb6HUMWPY5aTWuNIgbwc5lkpIDK2pzfRg54JSuBrXw9C6PJmERmrF1lQtaxqnMTXbM6GP0p/JFqxPgv6+i2FZ+FcKrb89gQkdTiMoXP3zSAtZYZs9qzazpzmHnapGeMMLiyWCxIneJaqkwz4vytbS4N5CgohRJCFdctoUntZERmipPAqZ8t/JKrfZQWAZdYxjnQ8T1MJ9hgP94vvErrsUpjFa5LrjHmFGw3ZmVfUGlATYWV666u+Z9sOVfO6xa/nSuf9JvmsWyUQzOzrnMOend3LK/Oe5MfJ9YvZcGusFf3oiye9XRmioGf60UggkmhnKIxpm3G62VpppS6cB0NhUy9SyIAEUHZeufV04uRKlfKksIIE2iFFmYxmJXstKFsLMuetyopl6imQRDB2A6xUuAJFPEqrN0/SF/0R98ruUNs5HK4m7d+pIu+wk6NrwdeBGgoz28SM9tGG+XsHNaoS6bA10tCwnKpK4ISvIVRwBoTUoH1P5rK1r4sMXvYsqJwi65yyb1Q3TMJQC1yEfifP4tHk8N2UWU16BgrWzRydyrzWeJCI2fkcj3u4jz57Adj7HKIKFgEJPHlMrwkL1k6Oh6f+uryW28LHNoe86SgsMtKFRyIm3DAsB32ByxGorgWXVNYF1P0swieUa+omVITR7slV88qSHmVHXQrp91oCRQZWvI1W/gQ8t/x2/3nIhXzrzeySsPCiLC+76L94882F+ctF/sDdTTyKu2ZGuY2bb/Xxr4bMUzeSwB2MKF09b/Lnl7+lyagkbY2w1CbhFl2RjkiVnL2H9Hau4+2O3Mv91x9B03CwalzZRM6eeqXPq+/LAtNLk2zLE6hNY0dA4jbmy4JgGKlbEzCaYec+l/cRqbBvT0kM7Bs6OGQjbJTR/O6oUwu9JIMwxyfW/Ao8zTPb8yEgEpROHz3gPMIihXQutrL7e9qPhhiLM627nmhceozWaIGMfSIV53wuPs7SjGcJR0naYv9+0htfs2jxkqc2onDh/wNNJdwmjokhJW/zG+wDP66VfqBE9K0df6yBOJ/DlfzHsEhqqZzXQsaU5yFg+xAGI3gLotAoF8+7JoAf9IUz59Wkm5/vdSmBZdR/CNn49+IXuUpjZVd1cvWQNFCMHtfeWwodCikXJPSipcAop7GgnK7edQ3U4w2/f8Cm2OzOJ6DQ5s5b920qscLaTqLGxRxiJs6TCVWrMF0Z/itkic04Kaot3PLYJ3/HZ9dhmtt6/LjAK42Ei1THMcPlr16A8RTgVIVpfRWJKqu8zGpZBvjNHz64OkjNridTE8N1AQLQGpERaEiebpdjRzYJVV5HoaSQ/DrEagNBo18TrrA6ejk2sellJ4OLfNP4dM7382DPi4eEzHhO0KxxleqaLr638TXmcpd93ohTZaILmRIqw7/NPqx5A+N7BCaZj4YOHqTSnl3o6eEKfwB+9C6gXnX+poedOD2PUmNQQfJ6gkdmQv6xXconVJQglwnglF8Oa+EcRBB1FM16EE8OtFLXBumKjBh/fL9cfjj9xdOQsvLGxmSDm1D0J2+rDEJq9uSr+5cSHmVm/j3Rn/dCfTyi6nDgRK49tFUFL0qUqzpqxCjPUQ747RrXVyv5cA7p1P1NDrbg6NeJ3JYQOHhM4brfkMu+U4I6797kdJGfUYMeCr1nrYLou3/HwigcCzNKQtG/sgY3NJGfW4jvBSFW2Jc2ssxfylpvex3M3P8TOh14iUg6ySwnS98nv7aKUy6CVws7GcQFNtO+yVoDGjoOOc9Bc1iNiEIQM8v1f1EpghL1gKLFkDm7FfDPB7MkrxrEfCK7xekYQLB+wPJdkuhPyCoYLg2iNlgadiSSG1sQLuaB7qJIMEDsN8UIOzzBxpUFXbOQ5SkeiZogPM6l4mEQp9M2e42F8iTEE0YdgHvAvlKfTHozveoRTMeL1Sdo27zskwdJAxovygeRL3JBazxY3To+yCIdcWnqq+MFL51BQJvaRnf5rI4EbmBltwfESWFddXL2417oaRkCkz758LTGzBFYev1TFyQ3ruXPnqWxsXULWsgiFTdq2eJwkV6FjJjt6pmAbI9QSSg9PmfhaIsfRrUH5ilA0xIIzF9G8ajvduzqomdtAoStHvi1DalbQFkaaBsr10UpBuYODFQuRnF5DoSsXzDkIFNMFahdMYdpJs9nz2Ea2/OFZYtXlOI8A7Xg4eQdp2TiRND21m5i+pxFX5PuERPoJhCy9GeRtBOX2Y/1AIeB/gA/1f9EIe5Ta4gipsWtyKPcg4XiY8QsWjJJrEgdaY1W8tOw0jExs2BQIVxrE3BInN+9Aalg59xg219TjSYlZrin0hcTQilk9XZzYspOI5+LKyZup7UikNbxI0Nzs+gmsewPwUwYmRwaowKyPNSRp27j3oLfHQ48KcXKkmY8kN3DC3ouISJ/b6p8gaRTJyyBT+Ag33zhsYtUbu/rUSQ8zs3EvPR0NI1hEGkMbxKQDOBScCNPrtnBR4yqufuyrfPCCv3JmYjWW08mje1dwu7qYrBvBGkHYVZDCw+yoT8wsMcJYyQCK2SL1c+qJhm1WP7wB5frkO7I0HjudhRcfy/M/f4xSOhgJdPMlhBBIy0Aakgu++lZybRke+NzvSE4P7tlCgCq7gF7JQ4t+48E6WEBawawbIp9g16wHWPpPdzEl6ZFPWwih0SUbI9XT7LXXIKQacfamITgoxcUIu5TaEghTEZ7aM5RgTfSOOWI+QQMOf6qdwiffcAWpdhNjGG+1IxJjcUczD9zxHbQQfPbsNxH2XBZ2tVIyAimxfY89iWp2VVXz2z/8mIbO1kktzzlSeVhfAd4No8xffzAJggD8dQe9I4ITLd6YxIqF0b5CGBMNkGuK2sDTklqjhI0mJjyiwidStgKOoGBtIHADJ12sILCu5lR1c9XiNUHF/0i+mRdmQXIPj7UuASWIKw833cDVy+4mFDVQmQh7tjTR1l3P1lwT1yy7l+nRdnLe8LWIvRbWyj3n01NKEjLG1nOslCsxfVkw5L7jsc2EU1Hy7RmWv+NUFr/5eJ79ycOUsiWssMXFX38nM89aiPZ8nr35Yeact5TnfvowekJTemtC0qS7U7ClbR9nn7Mb3VwudwnKWDZq31CIcZdELATOAh7t25MvkLYf5FANnct22gQ+QAejxK98JLbvU5/PkiyYSH/ok0JqTXUxjwZK0iDqOnzlkT9y+qbVEC8PtOSzbJg+j2suvhxHmvhCEPI9LOW/sjLdR6EF+BqDeliNkWuBnxE0nBuAX3KJpOJEq+NkW7uDkaAJkJIOa4v1fLNnCXc1PMJuP8pOL0bIsGkpT7x6hBrHrgNOZZRyionSf2RwZsNe0p0jWVeQL6a4bMF93LLlfH605jI+cNr3MdsX4hbreee831HIJehsnsp7Z/yF2PKWIJ7hWaRGivcZDvg2xl4fXxlj6tiudZDIueCsRbideTo2t2CFLUR1jDnnLmbLfS/SsbkFaUpmnDKXBeWGfWt++QQb7l7NmR+/+JC6NGihiMcM1t69gAVn7mLacdvp2VPV6xruRehNKLl4Apu+kbEnib6Ng/Mox8JGRjmfNGAhsLRCaoUxTD2hoRVGbxJt+XnWDkE0TnfZikppTToUwdBBxYuhNV12BMcw+rLfx8OcQc8Pm2CZ+HTpJGnimHjs041f79Hx90vUnGZdTxu1pMhglEtmRuGrDDGDjPIVkVSMeGOS7t3tExYsgKSZ45b0Ah4u1uMh2F2qEVgKuyBYAUSkd7h7uq8jcAPHPs4/TvpGBhevgWJ0yIl/++P4FtGww7fO/DbXPvoxim6Mf1x6N1ZoN3SHiUQcpiWbIdoDxRjP7F1OeylOyBh++FoKhdKSkmdjm2NrkOi7PrHqGNPmTmHTH1dT6Mpjhk1mn72IUFWEzfeuDQqlHZ8FFwdi9exPHuaua37CrLMXAWCGrL5hSSEEylOUMkHukGGPPl+6Gfbwu8I8dduxvHFhB1a8hO8Eaqt9+ThB3d74UOJCYXk/NqPu+9ESM17CjLgIU2EnSniGxstbaNc4A6l/Od7NC61QOvyIC8hR8rB2zfEoRjyqxunZKiFAiKB2EECIA4UOWiPcEk81zeb5+hlUl/LDbmc4PjHo+aQIlkThYdKuq/HLJTBZopwsXmCp2EKGGO262lsuN37ZEOrmNxl/4SH/FDbq2dSKHqIURyuAvoCgsPf2wW9opYnVV2H0Ts80Aauzd7WkmWenF0UCVVbWcC1FxDGBxOHu6f4igWV12MTKEJq92So+edIjY7KuIBCX7mwji2s3c/v5X+Tfn7+Kdz/8Ec5t2sDFC7aSznhUhzv4w6Y38ujepSipKSkLY4RguqcFptCc3dBC0ipRUqObWPl0nnknB6ODmx94sZxuUGTu+UF/9p2PbULaJjXzGzj2Hafywq+eXHr3dT//emp2XTRUFZYApXQBIUVQi1h0ybdnqJqWAqDQkUUaQx5H0NAAvqaVeLaqMcfWR2ex4f55LH/LBtJ7+yIcvwPeO+42w5aP9sxrvJ3TzkWZ/6FjxcfU/sY2YSjh2tFqv2Qs0tXNV2J5lw4XCB8WoVHFKNHF6/63Nmti1g6dwqeBhmaP4skhCk4Socd2W9YiuNul8llId1Hb28gvn6E6H8xEJACUYkPtFB6fMZcp5Wz4Q2FSBMvHwMPgDPkccfK4mLToWt5p3MNl5h04OolG4GL+pFOnPvT/zO+f/P+sr/E993q+6b0HUwTF0aPwZYJJJwYEHt2iQ1VDFbqqip6sgtBERiQGqpwC0r4JUuOXT5RJKtEZijUEsYkRZ7A+VLpLYeYku7hq8fNl62psqQVSenSnm6gNZfjmuV/lmZcW82z1WxEXHMu2x16gTj9DFyHeveDPnD3tRcJGCX+Etr+GdPGVxa+2vp22Yi1Rc3SN9koeC85cCMDeZ3cQSkQwbYuFFy9n219fIr23G+35LHx9MID27E8emZ6aVfeJUrrAwtcvB2DzvS8SqY1T6MjRvauDS75zJad88Dxe+MVjrPv1k8SbUiMdwh3As0FKhqBjZxVM340divaOqN2DFs+jxfHjEa3wlB467zuN+7/hzS81rP6RRQz0dgXg6pK0MzO58NOampM3U2wb4wxivUiNykUfafz0tx4VkeKwI3+WdLH8Alubv01XxwoSkeZhN9kZiVFbrgc0lU/aDnP3wuPoiiXoDgVxvSqnyNq6JjrDUWzfAwTPN0zn6amzmZbpHt9nGIJJEaxmXc958glutm7AxaSETVykWaeW8F7329i4WOUm6506+YVOqu+5yvgN11lfZYeewa/91zND7B9tN3MISky+2P9F3/XxYwlWTIXkjm2o6NDlEr2CI3of5RNL0itX+sB75WWl7eHqMK3MxUNOtJ3zSDxHIFYTSAEeO6ZUbE+nuOHkh5jZuG+UkcGDkdKn4EbxMxbT4t3MPmUzviWIqG5qQ0UunvYkJ9SsoZifQk5FRxR3S4OrrDEbw8pTRBIR5p++kLY1u8ns60KaBtNPnUu0Ls6me9agfYUVC7HiXafTum4v7Rv2kWiqRivNse84lT1Pb2PfczsQQmDHw7zrro8w77VLeeHWx/m/639BanYdhm0OO/lEL1oLIg3dtK6dTvMN/w/l2kFXBtPDz8a/5rXV3SGEHnOr4VDIIrM7QnvyWvJ1O7ALIIzA1SgZEKGT1q/9gGKtRckbp/FteLjt1d8Qpoew3aGa/QEQy0s6Gkt474xwnn6B6Aiz56RDEWb2dKCFwFCK41r3snLmIh5vmtMXn1JC4Bgmx7btI1kqUIzGqSnmOXXfdlKliTgQxwx4NikTqTqYnCOfAZEmo2ci0Dg6yjTRwlY1g7VqEfUimJVIoP8vS+x/P6FueOP58inebtzD7/zXlYtgRhWEGwgC8Dv7XlGatBnjgumSM1o30xptGKZ7aa8sMeDvwf8WfS9GbIcON8FdzMXTgvGOW4/C8xwBsRJomvNxjq9v5tpjV0F+9PYqw2H7eVrtY5gzo4ltGwoUWrvx5kQolOJQSuKMoe5SaIXXu9wYjqNUKJGamiJsmjz3wLqg3KYrx9zzlwGw+8mtaKVpOn4WiaYUT373foQQtK7by7JLTyJaG+fOK35IurWTM69/Pa//xmUYlsFfPvMbVn3vAWrmNWDFQqOKVS/hZIHutjgb/u1y4roJhwLlsPWdWuTvdLT7do09JotckkTTif0uF9eC/iE92wY75LP//jNo9abiM9Y6PAGUEIR/J0j8YbSlPSBav43v1NyArcDzRo8D96Yw/NtDd+ELEbiHg47AKLuIaTvM1x75I6bvH7TcmHjzhQOeHrJgKQRRitSJTiCKW95kCZspYicXGw+xUc+lXnT1/YS1dH9ht576xjVqMfPELiIUxipYNkEh6NV9rwio9rM8FV/AWn85MivQgxPVBtY3H/zaMAjPRxWCH9Cc3BbJzwBnMIli5fgGvpIDLCdBMCX99u5abjz1L9TVNdPdNjWYFHScCDQ9GRPmTMOoS9F+9zYWxLdT8OuRWjFWFRTlkzbblSOdM/Gs4dMahBC07Whj2WuDu+zup7aifIUdC7HiXaex+c9r2f30VgzT4KRrXoNf8nj6fx6k2J1j4RtWcMm3LgfgtV98K3/3o/eSmlFDencHd73nJpqf20HdkiakKccsVgCiFMF1bHLXfpyGM9eiO4JJKLRZwsjXXt1o1B8vY7n5eqQ20WXsVIHsc8vY/vRcbNWJ5af6ffYsZs9spnzmC8QX7cPJjPFSFRqsUqu/beEH9d65EBreqvGFwPItZvgvEO7uAD8OI3SARSu0YdJZTmFI5dJDl9xojROO0B2OYipF9XDLTYBJcQkP3E36n7RBC78lYjs27mAr5lmJ+jGC97vl6b7GwVUEE0k+1PtCseAhqmv56cK1zM6+AHbtwDX6x8sH72ok3ySco6WzkTfxHvLKJDZCBvc4eIpArA7ZvxQEgfG9uSrChkcqVMTrF6tQWpB3ba5b8SRXLFyL11MzIbHqRVoC4Qm2PF0k3r0Fc0aIqFEiZPl4I01X1Y/ejp+zVsymmkZCI4y4e47H7BPmct4159OzrY0N96zGK7i89afXYIYsrKhNYkqSFVecyfxyKsOp172WaG2CM/7pQjo3N/PCzx9j6aUnozyfv3z2N6z+ycMYIZOGY6ajlBr3zDkIjW0rWtbPY8qpqwlN2Y9bCKOsLCI9tTB1eeG80IIdz3rZcMNom5K2R83cVaSWTUWLSwaU4mglEAiSS9ZjJvMoZ2zfr7AdrdJVb8w6fruetX5wec+B7QO2UGjtsWV3FNW9DGGN/F34QmIrjynZNAJ4qWEaaTsMWiD6tR8I+x6N+TQx18GVBhvqp1EyzAlNSHHsoOeTIlg6aJQ74DUBOFRxrNxAQmTZoOaRFEEupEKwV0/5sqPtqw3pDz+B4fB8maCXOQBh7aKjET7JRfRsmUuhqnqgW1gutO3f3erAXzGg7ZjWfctoLB9yweHFJqcs50kCsZoUc00KzY5MNW+d+xKfOuFRlBYU/QM/qdICCcyrbUFrSc4JTViwNIJQ3KahbRWlPc8QtiJ06lqSKtM3AcFYcEseImRz0bUXIhP1Y9u36xNrSnHujX9H3aIpLHvLSWz8w3NMOW4m/7LrmwCs/unDSNPggi+9DYBNdz/Pnz96G/m2NE9+696ghlBrqmbUYISssbVKHgYrWiC7p4nmJ05i3oWP4+TjYAm0a+EUxB4y5go/Zz7GKLNAa99GhkvUnbEVocxBHUcESJ9ij4HbHhlWeAbhClufo/JilZuz0G5k2CJrJQQN+U5+OON0vnLe2Ux3R/8du8JR5ne18qu7f4oAPn3O37O5up7q4oF0BVca5Cybb/71t1y04VnaU/V89qw38mJ9E7VDTNs1Go8Pen5YE0e7dRVNooV/Mn7GarGMahH44RpBt67aNUPs+/cenbhxAps+C3gPQdlO0PlRwfra+Swx15FS3aj+5qcefpTvIONK9P2RhnQpiSi7aEJxyMmjTxCI1aQggM5ihMZwns+dcR+Nta2QTR4c8BWaQilMyTMPyboCKPo2yVCBSDzN6rZjAhNxOMt1GMyQiQ+s+s795HUj1khtT2yTQmeWTf/3Amff8EZe8+k3AvDo1+7mr5/7HbPOWcRxV59Fx+YWnv3xg5ghk50PbyTXlmbPE1uIT0lSNX0WXslDCNFXRzgeF3AotBaE4jla1ixiyoqN2NECxV7nXgtQohkt5gG/JGh/PCRCarRjUWgfLjoaXJ5CMGzQvB8bgdehxe7RltVArVNgb6SGW6Yfh2lCUY8eoc1bNkUzuIE70qA7HOHjz/yF83dspCMSI+o5dIeiXH/B2+kIx0BptBAULJu8FSI6kfYygzisgqUQZHQV7zF/i8WtDDyrFZD/t4f8i69RyBG7mQ2F1vpfpWH8yghZBbQmrQ0WzE5ye9eLWD3NYE+gQlxLMFwIpYOZHCM5WjqaeNNzSygoi9gYy0iG4BHgnFGXGgdSaPbnEnzm1AdprO6gp23qiCN/w00kMa59onC1RVgFWc1SalBgCR9fCSKWgWXKkfvGhCSUJGu+/xgt+8PE4sNbrlpppGVgx2xW3vAbXrj1CUo9ebp2tDHt5DnkWtPc94lfYoRtauY1oLVm+8p1GCGLmgWNCIIEUTnhkq3hsaJFsi21NK9ezNwLH6PYOeTsNJcBPyYIYcya9IM4wGcJyt/GhBaCiJPljhknsSVSy+Jc25jKZkqG2dfTSgmB7Xkc27aXufu2MTdWBU4JJxIjVSqU87SCbUY8l5hbIuoeekjlsApWr7PVroOCUxuvL6tdoKkTnXkH88sm/vfGezlJ05iG1p/Jt3Z+FgSW7GGVkeJBvZDXeV1k5PBN5IbDkh6ZQi2b206kKuxSWyyyNR1sR4oJ57lPulgBdJbCzK/u4KrFq8sjf0eu2lFQnjHb8MiUIsQ8l1B9mFJO0tlTwhhhIlXL83A9k8T0arxYgnB49JNYyEB4ura2IEyD5IxaEBCqihCqOiAUQgjiU1PBE82oTR0PBa0FoURgZTWu2IiVbB8uFvsXYDbwVoJR7hMn6RAywA8Jupl0jmfFarfIzngDv21cQoOTndDoXW8KUE8oAtE4HZEYMdOiKxwN5gM9xAlrh+Ow1xKGccgR4bPuR9nLFKr6FY4bKBzM71eJ7AcVYvmYN6ohFI+w79lNn9nxxKa77VjkKQSk3SruqknwuoYIwtVjKfkZeKyhLOu7ZnLt8++lLtZO1PJwSgrIEZYuE8gHeJhgLsVJRQPdxQjXr3iSqTWt9HTVHY6JXnvt9xyDBgh8LQlLh6xvI33JtESJlU+3Jv7xN1sKbTmHRGj406qkSoRkiI8vOJFpcZuMN6pgFcszQGfC1f2SJ4+MPksgxjCjuVa0SK6tmv3PLmXW6x/AG/k3+F35MZ+gLvB8gsaM1WM8Fk1QGP8ocDfwJybYvSHmFfnejJPZHK1lYa5jvEXJvT/YWIvzE0xiUvRIgvU8wXTb3WPYjgSaGKKFbwmLqaIZG5dH/JP7+mQBKCQWLkmR+ayB/pFG7GfkNt8+oIyw5edbOwvNa3cuQBjHa6WeCjbosqaUAmVjCo0T+PJFghbBgtG+uCDgbiXM7rjlbsv6pRJCWUBteUh2XFfJcxwGsQJQWhK2XJZP3T1q/+1D4B6Ci+mggI+rTRJmgS43RgJFwizyxXt3yM1teQegOz/adVTEVxo5tkkhPkMwyHKYSzmHRTJM8bDWAsPyyTbX4Zfssd40tgD/Xn6YwCICEZtK0K+utxeLQ9AWpoWgH/8GgpnPDwkBICTNoTiG1hOxrr5D0ExwrL+HwSSWnI0kWOdOxg58DMBhltxLUmX6Au/90Yi7CX6wMWGYJpl0Dq/kYkfD/eatNAhJf3AMZQcwRutN4CtJ1HKotgoYukhXNoXrmVjmuG9mj46+yMSQQlN0LTa1TeWcmVsO125chr1ZaZQOcr6CaQYl4RHcwEOkyGEuWzokhMaw3Ykm43oERe/rJvWYxkDUd5FaTcRQLZUfLwuHvWtKEMcycLQ9aaUtWmukaSBNA60HJnccased4CIMPPSSZ9OeHrnl7wgM3xTqEBFoEqESP1l3Ip3dtSTDhSPdYPDgYzr0VkcVKozKEWrzdHShNVimR08uTqEUwhyuBePIHFYXpj6cZ217I7duWAGxzFiGvStUOOqpCNYQGFLheibdmQTGxHOXJr1SesDGtaAhmuX2jSvo7KwnGT5snWkqVHjFUBGsQWgtCNk+Pfk4+YlbV3Do3umIaKA+kmddRwO3bVoOsUzZla1Q4W+XimD1R0M05JEvWrR3JzCNw2okHTJaCxqjWW7bsIKOipVV4VVARbDKKCUhWkAYRXbuhnzRwLZerpH0saGBul4ra2PFyqrwt09FsAjEKpXsIpup5TMPnYfrF4lY/qFe/EdE7XqtrNs3Lqezq+4VMWJYocLh4lUvWL1iVShFeOvdl/PX/bOZGh9/s/yhNj0ZGxmNA7Gsyohhhb99XtWCFYhVJ4VSmDffdRVPtTaxtLptQE+pQ+CIqYbqs7J6RwwnRXArVHjF8aoVrD6xKkb5u7uu5unWqSytbsM/fKUuh43+I4a3blwOsWwlllXhb5Kj7+qcBAaI1R+v5Km2qSytOTrFqpf+VlZHxcqq8DfK0XuFTpD+YvXmPwRu4LKj1LLqT/8Rw1srI4YV/kY5uq/ScTJYrJ5uK8esjnKx6qV3xPCXG1fQ2RVYWZURwwp/S/xtXKljoHc0MF+M8uY/XMmqtiaWVrceTsvqiJs3vVbW+s4Gfr7hOIjmKiOGFf6meFUI1gHLKsLflS2rJYdXrOAIpTUMRmtBQyTLLzcuZ39rE8nQK7czS4UK4+VvXrD6u4Fv6ucGHmaxagG+cTh3MBwaSIWKNOfjbE1Xg/2ytS6qUGHSOewtko8oSiItD6o7Cfs2YS0hXCDb0cBb/ngFq9qmHm43EKAVOBnYfTh3MhKelsRMl4jpwuTklFWo8Irgb0uwIkXasgl+/9Q55KREC0jaJW5afwLPtE1h2eEPsLcQ9Oneczh3UqHCq5W/KcFKhPN0v9DItRuPxY16CMBVBrXhPEtq2icrg304KmJVocJh5m9GsJywT7wjTFObidfQgR40U25FrCpUOPr5mwlwaAl1+8IYnkAZRzT7qIVgrrmKWFWocJg5+gVLB9ZVotOmujVEKayO5JyizQSW1d7RFqxQocKhc/QLlghyI18G66riBlaocIQ5ugWr17rqOuLWVSuBG1ixrCpUOIIc3YJ15K2rhvLfihtYocLLwFEtWK6tSHbYpNqOmHX1EvBaXsak0AoVXs0IrSv1/BUqVDg6OKotrAoVKry6qAhWhQoVjhoqglWhQoWjhopgVahQ4ajh/wNE94LTR1vtIwAAAABJRU5ErkJggg==';

// Descriptions for sub-dimensions
const subDescriptions = {
    "R1": "Technique/pratique",
    "R2": "Plein air, Sport, conduite",
    "I1": "Sp√©cialistes orient√©s application concr√®te",
    "I2": "M√©tiers de la recherche orient√©s production de connaissances",
    "A1": "Pratique artistique/expression de soi",
    "A2": "Culturel et organisationnel",
    "S1": "Sant√©, m√©dical et param√©dical",
    "S2": "Accompagnement/enseignement/formation",
    "E1": "Management, gestion d'√©quipe et m√©tiers de l'influence",
    "E2": "Vente/n√©gociation & marketing/publicit√©",
    "C1": "Gestion administrative & financi√®re",
    "C2": "Ordre s√©curit√© et juridique"
};

// Score mapping
const scoreMap = {
    '--': 0,
    '-': 1,
    '+': 2,
    '++': 4
};

// Shuffle function
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// Update progress bar
function updateProgress() {
    const totalQuestions = questionsData.length;
    const answeredQuestions = document.querySelectorAll('input[type="radio"]:checked').length;
    const progressPercentage = Math.round((answeredQuestions / totalQuestions) * 100);

    document.getElementById('progress-fill').style.width = progressPercentage + '%';
}

// Export results to PDF
async function exportToPDF() {
    if (!currentPercentages) {
        alert('Aucune donn√©e √† exporter.');
        return;
    }

    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    // Set margins
    const marginLeft = 20;
    const marginRight = 20;
    const pageWidth = doc.internal.pageSize.getWidth();
    const pageHeight = doc.internal.pageSize.getHeight();
    let yPosition = 25;

    // Add logo image using base64 constant
    try {
        console.log('Checking LOGO_BASE64...');
        console.log('LOGO_BASE64 exists:', !!LOGO_BASE64);
        console.log('LOGO_BASE64 length:', LOGO_BASE64 ? LOGO_BASE64.length : 'N/A');
        console.log('LOGO_BASE64 starts with:', LOGO_BASE64 ? LOGO_BASE64.substring(0, 30) : 'N/A');

        // Check if the logo base64 is set (not the placeholder)
        if (LOGO_BASE64 && LOGO_BASE64 !== 'data:image/png;base64,YOUR_BASE64_STRING_HERE' && LOGO_BASE64.startsWith('data:image/png;base64,')) {
            console.log('Logo base64 seems valid, attempting to add to PDF...');

            // Simple approach - just try to add the image directly
            const imgWidth = 80;
            const imgHeight = 30;

            console.log('Adding image with fixed dimensions:', imgWidth, 'x', imgHeight);

            // Try adding the image
            doc.addImage(LOGO_BASE64, 'PNG', (pageWidth - imgWidth) / 2, yPosition, imgWidth, imgHeight);
            console.log('Image added successfully to PDF');
            yPosition += imgHeight + 10;
        } else {
            console.log('Logo base64 not valid or not set');
            throw new Error('Logo base64 not set or invalid format');
        }
    } catch (error) {
        console.log('Could not load logo image:', error);
        console.log('Error details:', error.message);
        // Fallback to text if image fails
        doc.setFontSize(24);
        doc.setFont('helvetica', 'bold');
        doc.text('RIATEST', pageWidth / 2, yPosition, { align: 'center' });
        yPosition += 10;
    }

    doc.setFontSize(18);
    doc.setFont('helvetica', 'normal');
    doc.text('R√©sultat du RIATEST', pageWidth / 2, yPosition, { align: 'center' });
    yPosition += 20;

    // Date and participant info on same line
    doc.setFontSize(12);
    doc.setFont('helvetica', 'normal');
    let infoText = `Date: ${new Date().toLocaleDateString('fr-FR')}`;

    if (currentParticipantInfo) {
        if (currentParticipantInfo.prenom) {
            infoText += ` | Pr√©nom: ${currentParticipantInfo.prenom}`;
        }
        infoText += ` | √Çge: ${currentParticipantInfo.age} ans | Sexe: ${currentParticipantInfo.sex}`;
    }

    doc.text(infoText, marginLeft, yPosition);
    yPosition += 20;

    // Dominant profile
    const sortedCategories = Object.keys(currentPercentages)
        .filter(key => key in descriptions)
        .sort((a, b) => currentPercentages[b] - currentPercentages[a])
        .slice(0, 3);

    const dominantProfile = sortedCategories.map(cat => cat.toUpperCase()).join(' ');
    doc.setFontSize(14);
    doc.setFont('helvetica', 'bold');
    doc.text(`Profil RIASEC dominant: ${dominantProfile}`, marginLeft, yPosition);
    yPosition += 15;

    // Results for each category
    doc.setFontSize(12);
    doc.setFont('helvetica', 'normal');
    Object.keys(categories).forEach(category => {
        // Check if we need a new page
        if (yPosition > pageHeight - 60) {
            doc.addPage();
            yPosition = 25;
        }

        const symbol = categorySymbolsPDF[category];
        const percentage = currentPercentages[category];
        const description = descriptions[category];

        doc.setFont('helvetica', 'bold');
        doc.text(`${symbol} ${category.toUpperCase()}: ${percentage}%`, marginLeft, yPosition);
        yPosition += 8;

        // Excellent professions for this category
        if (currentExcellentProfessions && currentExcellentProfessions[category] && currentExcellentProfessions[category].length > 0) {
            doc.setFont('helvetica', 'italic');
            doc.setFontSize(10);
            const professionsText = `M√©tiers appr√©ci√©s: ${currentExcellentProfessions[category].join(', ')}`;
            const professionsLines = doc.splitTextToSize(professionsText, pageWidth - marginLeft - marginRight);
            doc.text(professionsLines, marginLeft + 5, yPosition);
            yPosition += professionsLines.length * 5 + 3;
        }

        // Wrap description text
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(10);
        const descriptionLines = doc.splitTextToSize(description, pageWidth - marginLeft - marginRight - 10);
        doc.text(descriptionLines, marginLeft + 5, yPosition);
        yPosition += descriptionLines.length * 5 + 10;
    });

    // Try to add radar chart if html2canvas is available
    if (window.html2canvas && document.getElementById('riasecRadarChart')) {
        try {
            const canvas = document.getElementById('riasecRadarChart');
            const canvasImage = await html2canvas(canvas, {
                backgroundColor: '#ffffff',
                scale: 2
            });

            // Check if we need a new page for the chart
            if (yPosition > pageHeight - 120) {
                doc.addPage();
                yPosition = 25;
            }

            // Add chart title
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text('Graphique RIASEC', pageWidth / 2, yPosition, { align: 'center' });
            yPosition += 10;

            // Add the chart image
            const imgData = canvasImage.toDataURL('image/png');
            const imgWidth = 100;
            const imgHeight = 100;
            doc.addImage(imgData, 'PNG', (pageWidth - imgWidth) / 2, yPosition, imgWidth, imgHeight);
            yPosition += imgHeight + 15;
        } catch (error) {
            console.log('Could not add chart to PDF:', error);
        }
    }

    // Footer message
    if (yPosition > pageHeight - 40) {
        doc.addPage();
        yPosition = 25;
    }

    doc.setFontSize(10);
    doc.setFont('helvetica', 'normal');
    const footerText = "Pour une interpr√©tation approfondie de vos r√©sultats et pour conna√Ætre les formations et m√©tiers associ√©s √† votre profil, nous vous invitons √† vous faire accompagner par un psyEN.";
    const footerLines = doc.splitTextToSize(footerText, pageWidth - marginLeft - marginRight);
    doc.text(footerLines, marginLeft, yPosition);

    // Save the PDF
    doc.save('resultats-riasec.pdf');
}

// Generate questions
function generateQuestions() {
    const shuffled = shuffle([...questionsData]);
    const container = document.getElementById('questions-container');
    shuffled.forEach((question, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'question';
        questionDiv.dataset.questionIndex = index; // Add an index to track questions
        questionDiv.style.display = index === 0 ? 'block' : 'none'; // Only show first
        questionDiv.innerHTML = `
            <p><span class="profession">${question.profession}</span> <span class="info" title="${question.description}">?</span></p>
            <div class="options">
                <label><input type="radio" name="q-${question.dimension}-${index}" value="--">--</label>
                <label><input type="radio" name="q-${question.dimension}-${index}" value="-">-</label>
                <label><input type="radio" name="q-${question.dimension}-${index}" value="+">+</label>
                <label><input type="radio" name="q-${question.dimension}-${index}" value="++">++</label>
            </div>
        `;
        container.appendChild(questionDiv);

        // Add event listener to show next question
        const radios = questionDiv.querySelectorAll('input[type="radio"]');
        radios.forEach(radio => {
            radio.addEventListener('change', () => {
                updateProgress(); // Update progress bar
                if (index + 1 < shuffled.length) {
                    const nextDiv = container.children[index + 1];
                    nextDiv.style.display = 'block';
                    // Optionally scroll to next question
                    nextDiv.scrollIntoView({ behavior: 'smooth' });
                } else {
                    // Show submit button and participant info when all questions answered
                    document.getElementById('submit-btn').style.display = 'block';
                    document.getElementById('participant-info').style.display = 'block';
                    // Scroll to info section
                    document.getElementById('participant-info').scrollIntoView({ behavior: 'smooth' });
                }
            });
        });
    });
}

// Calculate scores and percentages
function calculateScoresAndPercentages() {
    const scores = {};
    const percentages = {};
    const responses = [];

    // Calculate item counts per subdimension
    const allSubcategories = Object.values(categories).flat();
    const itemCounts = {};
    allSubcategories.forEach(subcat => {
        itemCounts[subcat] = questionsData.filter(q => q.dimension === subcat).length;
    });

    // Get the profession map
    const container = document.getElementById('questions-container');
    const questionDivs = container.querySelectorAll('.question');
    const professionsMap = {};
    questionDivs.forEach((div, index) => {
        const professionSpan = div.querySelector('.profession');
        if (professionSpan) {
            professionsMap[index] = professionSpan.textContent;
        }
    });

    // Sub-dimensions
    for (const [category, subcats] of Object.entries(categories)) {
        let totalMain = 0;
        let maxMain = 0;
        for (const subcat of subcats) {
            const radios = document.querySelectorAll(`input[name^="q-${subcat}-"]:checked`);
            let totalSub = 0;
            radios.forEach(radio => {
                const value = radio.value;
                const name = radio.name;
                const match = name.match(/q-(\w+)-(\d+)/);
                if (match) {
                    const index = parseInt(match[2]);
                    const profession = professionsMap[index];
                    responses.push({
                        profession: profession,
                        dimension: subcat,
                        value: scoreMap[value]
                    });
                    totalSub += scoreMap[value];
                }
            });
            scores[subcat] = totalSub;
            const maxSub = itemCounts[subcat] * 4;
            percentages[subcat] = Math.round((totalSub / maxSub) * 10000) / 100; // round to 2 decimals
            totalMain += totalSub;
            maxMain += itemCounts[subcat];
        }
        scores[category] = totalMain;
        const maxScoreMain = maxMain * 4;
        percentages[category] = Math.round((totalMain / maxScoreMain) * 10000) / 100;
    }

    // Sort responses by profession for consistent order
    responses.sort((a, b) => a.profession.localeCompare(b.profession));

    return { scores, percentages, responses };
}

// Display results
function displayResults(percentages, password = null) {
    const resultsDiv = document.getElementById('results');
    let passwordDisplay = '';
    if (password) {
        passwordDisplay = `<div class="password-info" style="background-color: #e8f5e8; padding: 10px; margin-bottom: 20px; border-radius: 4px; border: 1px solid #4CAF50;">
            <strong>Mot de passe pour r√©cup√©rer ces r√©sultats :</strong> <code style="background-color: #f5f5f5; padding: 2px 4px; border-radius: 3px; font-family: monospace;">${password}</code>
            <br><small style="color: #666;">Conservez ce mot de passe pour acc√©der √† ces r√©sultats ult√©rieurement.</small>
        </div>`;
    }

    // Store data for PDF export
    currentPercentages = percentages;
    const prenom = document.getElementById('prenom').value.trim();
    const age = document.getElementById('age').value;
    const sex = document.getElementById('sex').value;
    currentParticipantInfo = { prenom, age, sex };

    resultsDiv.innerHTML = '<h2>R√©sultats</h2>' +
        '<div style="text-align: center; margin-bottom: 20px;">' +
        '<button onclick="exportToPDF()" style="background-color: #2196F3; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">üìÑ Exporter en PDF</button>' +
        '</div>' + passwordDisplay;

    // Get the profession for each question from the original shuffled order
    const container = document.getElementById('questions-container');
    const questionDivs = container.querySelectorAll('.question');
    const professionsMap = {};
    questionDivs.forEach((div, index) => {
        const professionSpan = div.querySelector('.profession');
        if (professionSpan) {
            professionsMap[index] = professionSpan.textContent;
        }
    });

    // Collect ++ professions per main category
    const excellentProfessions = {};
    Object.keys(categories).forEach(category => {
        excellentProfessions[category] = [];
    });
    const excellentRadios = document.querySelectorAll('input[value="++"]:checked');
    excellentRadios.forEach(radio => {
        const name = radio.getAttribute('name');
        const match = name.match(/q-(\w+)-(\d+)/);
        if (match) {
            const dimension = match[1];
            const index = parseInt(match[2]);
            const profession = professionsMap[index];
            // Find the main category for this sub-dimension
            const mainCategory = Object.keys(categories).find(cat =>
                categories[cat].includes(dimension)
            );
            if (mainCategory && excellentProfessions[mainCategory]) {
                excellentProfessions[mainCategory].push(profession);
            }
        }
    });

    currentExcellentProfessions = excellentProfessions;

    // Display all categories in original order with main details only
    for (const [category, subcats] of Object.entries(categories)) {
        let profs = '';
        if (excellentProfessions[category] && excellentProfessions[category].length > 0) {
            profs = '<p>M√©tiers appr√©ci√©s : ' + excellentProfessions[category].join(', ') + '</p>';
        }
        resultsDiv.innerHTML += `
            <div class="category-results">
                <h3>${categoryEmojis[category]} ${category.toUpperCase()} (${percentages[category]}%) - ${descriptions[category]}</h3>
                ${profs}
            </div>
        `;
    }

    // Sort categories by percentage descending for top 3 summary
    const sortedCategories = Object.keys(percentages)
        .filter(key => key in descriptions)
        .sort((a, b) => percentages[b] - percentages[a])
        .slice(0, 3);

    const dominantProfile = sortedCategories.map(cat => cat.toUpperCase()).join(' ');
    resultsDiv.innerHTML += `<h3>Profil RIASEC dominant: ${dominantProfile}</h3>`;

    // Add radar chart
    resultsDiv.innerHTML += `
        <div class="radar-chart-container" style="text-align: center; margin: 20px 0;">
            <div style="position: relative; display: inline-block;">
                <img src="RIASEC Plan de travail 1.svg" alt="RIASEC Background" style="position: absolute; top: 0; left: 0; width: 400px; height: 400px; opacity: 0.5; z-index: 1; pointer-events: none;">
                <canvas id="riasecRadarChart" width="400" height="400" style="position: relative; z-index: 2;"></canvas>
            </div>
        </div>
    `;

    // Add combined exploration and accompaniment section
    resultsDiv.innerHTML += `
        <div class="exploration-section" style="background-color: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
            <h3 style="color: #495057; margin-bottom: 15px;">üîç Explorez vos formations et m√©tiers</h3>
            <p style="color: #6c757d; margin-bottom: 20px; line-height: 1.6;">
                Pour une interpr√©tation approfondie de vos r√©sultats et pour conna√Ætre les formations et m√©tiers associ√©s √† votre profil RIASEC, nous vous invitons √† vous faire accompagner par un psyEN.
                En attendant, vous pouvez explorer d√®s maintenant les formations et m√©tiers qui correspondent √† votre profil gr√¢ce √† nos moteurs de recherche sp√©cialis√©s.
            </p>
            <div class="search-buttons" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px;">
                <button onclick="openRIASECExplorer('bac')" style="background-color: #007bff; color: white; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; transition: background-color 0.3s;">
                    üéì Bac Pro & CAP - Acad√©mie de Paris
                </button>
                <button onclick="openRIASECExplorer('parcoursup')" style="background-color: #28a745; color: white; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; transition: background-color 0.3s;">
                    üéì Formations Sup√©rieures - Parcoursup
                </button>
                <button onclick="openRIASECExplorer('total')" style="background-color: #6f42c1; color: white; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; transition: background-color 0.3s;">
                    üìö Toutes les formations
                </button>
                <button onclick="openRIASECExplorer('metiers')" style="background-color: #fd7e14; color: white; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; transition: background-color 0.3s;">
                    üíº M√©tiers correspondants
                </button>
            </div>
        </div>
    `;

    // Create radar chart after DOM update
    setTimeout(() => {
        const ctx = document.getElementById('riasecRadarChart').getContext('2d');
        const riasecData = ['R', 'I', 'A', 'S', 'E', 'C'].map(cat => percentages[cat.toLowerCase()] || 0);

        new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['', '', '', '', '', ''],
                datasets: [{
                    data: riasecData,
                    borderColor: 'rgba(0, 0, 0, 1)',
                    backgroundColor: 'rgba(0, 0, 0, 0.1)',
                    borderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6,
                    pointBackgroundColor: 'rgba(0, 0, 0, 1)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgba(0, 0, 0, 1)'
                }]
            },
            options: {
                responsive: false, // Fixed size
                maintainAspectRatio: false,
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            stepSize: 20,
                            color: 'rgba(0, 0, 0, 0.8)',
                            font: {
                                size: 10
                            },
                            callback: function(value) {
                                return value + '%';
                            }
                        },
                        grid: {
                            color: 'rgba(0, 0, 0, 0.3)',
                            lineWidth: 1
                        },
                        angleLines: {
                            display: false // Hide angle lines from center to points
                        },
                        pointLabels: {
                            color: 'rgba(0, 0, 0, 0.8)',
                            font: {
                                size: 12,
                                weight: 'bold'
                            }
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        enabled: true,
                        callbacks: {
                            label: function(context) {
                                return context.label + ': ' + context.parsed.r + '%';
                            }
                        }
                    }
                },
                elements: {
                    line: {
                        tension: 0 // Straight lines between points
                    }
                }
            }
        });
    }, 100);
}

// Generate a random password for result retrieval
function generatePassword() {
    return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
}

// Save to Supabase
async function saveResults(scores, percentages, age, sex, responses, prenom = null) {
    const password = generatePassword();
    try {
        const { data, error } = await supabaseClient
            .from('riasec_results')
            .insert([
                {
                    timestamp: new Date().toISOString(),
                    scores: JSON.stringify(scores),
                    percentages: JSON.stringify(percentages),
                    responses: JSON.stringify(responses),
                    age: parseInt(age),
                    sex: sex,
                    prenom: prenom || null,
                    password: password
                }
            ]);
        if (error) throw error;
        console.log('Results saved successfully');
        return password; // Return the password for display
    } catch (error) {
        console.error('Error saving results:', error);
        // In a real app, handle errors gracefully
        return null;
    }
}

// Validate form (all questions answered)
function validateForm() {
    // Remove any previous error highlighting
    const allQuestions = document.querySelectorAll('.question');
    allQuestions.forEach(q => q.classList.remove('error'));

    const totalQuestions = questionsData.length;
    const checkedRadios = document.querySelectorAll('input[type="radio"]:checked');
    const totalSelected = checkedRadios.length;

    if (totalSelected !== totalQuestions) {
        // Highlight unanswered questions in red
        const questions = document.querySelectorAll('#questions-container .question');
        const answered = new Set();
        checkedRadios.forEach(radio => {
            const name = radio.name;
            const match = name.match(/q-(\w+-\w+)-(\d+)/);
            if (match) {
                const questionIndex = parseInt(match[2]);
                answered.add(questionIndex);
            }
        });

        questions.forEach((question, shuffledIndex) => {
            if (!answered.has(shuffledIndex)) {
                question.classList.add('error');
            }
        });

        // Scroll to the first unanswered question
        const firstError = document.querySelector('.question.error');
        if (firstError) {
            firstError.scrollIntoView({ behavior: 'smooth' });
        }

        return false;
    }
    return true;
}

// Main submit handler
async function handleSubmit() {
    if (!validateForm()) {
        alert('Veuillez r√©pondre √† toutes les questions.');
        return;
    }

    const prenom = document.getElementById('prenom').value.trim();
    const age = document.getElementById('age').value;
    const sex = document.getElementById('sex').value;
    if (!age || !sex) {
        alert('Veuillez renseigner l\'√¢ge et le sexe.');
        return;
    }

    const { scores, percentages, responses } = calculateScoresAndPercentages();
    const password = await saveResults(scores, percentages, age, sex, responses, prenom);
    displayResults(percentages, password);
}

// Fill random for testing
function fillRandom() {
    const questions = document.querySelectorAll('#questions-container .question');
    questions.forEach((question, index) => {
        // Show all questions for random fill
        question.style.display = 'block';
        const radios = question.querySelectorAll('input[type="radio"]');
        // Deselect all
        radios.forEach(r => r.checked = false);
        // Choose random
        const randomIndex = Math.floor(Math.random() * radios.length);
        radios[randomIndex].checked = true;
    });
    // Update progress bar
    updateProgress();
    // Show submit button
    document.getElementById('submit-btn').style.display = 'block';
}

// Reset form
function resetForm() {
    const container = document.getElementById('questions-container');
    container.innerHTML = ''; // Clear the questions
    document.getElementById('submit-btn').style.display = 'none'; // Hide submit button
    document.getElementById('participant-info').style.display = 'none'; // Hide participant info
    document.getElementById('results').innerHTML = ''; // Clear results
    document.getElementById('prenom').value = ''; // Clear prenom
    document.getElementById('age').value = ''; // Clear age
    document.getElementById('sex').value = ''; // Clear sex
    updateProgress(); // Reset progress bar
    generateQuestions(); // Regenerate questions with new order
}

// Retrieve results from Supabase using password
async function retrieveResults() {
    const password = prompt('Entrez votre mot de passe pour r√©cup√©rer les r√©sultats :');
    if (!password) return;

    // Check for admin mode
    if (password === 'coP1') {
        await showAdminMode();
        return;
    }

    try {
        const { data, error } = await supabaseClient
            .from('riasec_results')
            .select('*')
            .eq('password', password)
            .single();

        if (error || !data) {
            alert('Mot de passe incorrect ou r√©sultats non trouv√©s.');
            return;
        }

        // Parse the stored data
        const percentages = JSON.parse(data.percentages);
        const responses = JSON.parse(data.responses);
        const prenom = data.prenom;
        const age = data.age;
        const sex = data.sex;

        // Clear current content and display retrieved results
        document.getElementById('questions-container').innerHTML = '';
        document.getElementById('participant-info').style.display = 'none';
        document.getElementById('submit-btn').style.display = 'none';

        // Display retrieved results with participant info
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = `
            <h2>R√©sultats r√©cup√©r√©s</h2>
            <div class="participant-summary" style="background-color: #f0f8ff; padding: 10px; margin-bottom: 20px; border-radius: 4px; border: 1px solid #4CAF50;">
                <strong>Informations du participant :</strong>
                ${prenom ? `<br>Pr√©nom : ${prenom}` : ''}
                <br>√Çge : ${age} ans
                <br>Sexe : ${sex}
                <br>Date : ${new Date(data.timestamp).toLocaleDateString('fr-FR')}
            </div>
        `;

        displayRetrievedResults(percentages, responses);

    } catch (error) {
        console.error('Error retrieving results:', error);
        alert('Erreur lors de la r√©cup√©ration des r√©sultats.');
    }
}

// Show admin mode with list of all submissions
async function showAdminMode() {
    try {
        const { data, error } = await supabaseClient
            .from('riasec_results')
            .select('prenom, age, sex, timestamp, password')
            .order('timestamp', { ascending: false });

        if (error) throw error;

        // Clear current content
        document.getElementById('questions-container').innerHTML = '';
        document.getElementById('participant-info').style.display = 'none';
        document.getElementById('submit-btn').style.display = 'none';

        // Display admin interface
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = `
            <h2>Mode Administrateur</h2>
            <p style="color: #666; margin-bottom: 20px;">Liste de toutes les passations enregistr√©es :</p>
            <div class="admin-list" style="max-height: 600px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px; padding: 10px;">
        `;

        if (data && data.length > 0) {
            data.forEach((submission, index) => {
                const date = new Date(submission.timestamp).toLocaleDateString('fr-FR');
                const time = new Date(submission.timestamp).toLocaleTimeString('fr-FR', {
                    hour: '2-digit',
                    minute: '2-digit'
                });

                resultsDiv.innerHTML += `
                    <div class="admin-item" style="padding: 10px; margin-bottom: 8px; border: 1px solid #eee; border-radius: 4px; background-color: #f9f9f9; cursor: pointer;" onclick="retrieveAdminResult('${submission.password}')">
                        <strong>${index + 1}. ${submission.prenom || 'Anonyme'}</strong> -
                        ${submission.age} ans, ${submission.sex} -
                        ${date} ${time} -
                        <code style="background-color: #e8f5e8; padding: 2px 4px; border-radius: 3px; font-family: monospace;">${submission.password}</code>
                    </div>
                `;
            });
        } else {
            resultsDiv.innerHTML += '<p style="text-align: center; color: #666;">Aucune passation trouv√©e.</p>';
        }

        resultsDiv.innerHTML += `
            </div>
            <div style="margin-top: 20px; text-align: center;">
                <button onclick="resetForm()" style="padding: 10px 20px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">Retour au questionnaire</button>
            </div>
        `;

    } catch (error) {
        console.error('Error loading admin mode:', error);
        alert('Erreur lors du chargement du mode administrateur.');
    }
}

// Retrieve specific result from admin mode
async function retrieveAdminResult(password) {
    try {
        const { data, error } = await supabaseClient
            .from('riasec_results')
            .select('*')
            .eq('password', password)
            .single();

        if (error || !data) {
            alert('Erreur lors de la r√©cup√©ration de cette passation.');
            return;
        }

        // Parse the stored data
        const percentages = JSON.parse(data.percentages);
        const responses = JSON.parse(data.responses);
        const prenom = data.prenom;
        const age = data.age;
        const sex = data.sex;

        // Display retrieved results with participant info
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = `
            <h2>R√©sultats de la passation</h2>
            <div class="participant-summary" style="background-color: #f0f8ff; padding: 10px; margin-bottom: 20px; border-radius: 4px; border: 1px solid #4CAF50;">
                <strong>Informations du participant :</strong>
                ${prenom ? `<br>Pr√©nom : ${prenom}` : ''}
                <br>√Çge : ${age} ans
                <br>Sexe : ${sex}
                <br>Date : ${new Date(data.timestamp).toLocaleDateString('fr-FR')}
                <br>Mot de passe : <code style="background-color: #f5f5f5; padding: 2px 4px; border-radius: 3px; font-family: monospace;">${password}</code>
            </div>
            <div style="margin-bottom: 20px; text-align: center;">
                <button onclick="showAdminMode()" style="padding: 8px 16px; background-color: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer;">Retour √† la liste</button>
            </div>
        `;

        displayRetrievedResults(percentages, responses);

    } catch (error) {
        console.error('Error retrieving admin result:', error);
        alert('Erreur lors de la r√©cup√©ration des r√©sultats.');
    }
}

// Display retrieved results with professions from stored responses
function displayRetrievedResults(percentages, responses) {
    const resultsDiv = document.getElementById('results');

    // Store data for PDF export
    currentPercentages = percentages;
    // Get participant info from the retrieved data
    const prenom = document.querySelector('.participant-summary')?.textContent?.match(/Pr√©nom : ([^\n]+)/)?.[1]?.trim();
    const ageMatch = document.querySelector('.participant-summary')?.textContent?.match(/√Çge : (\d+)/);
    const age = ageMatch ? ageMatch[1] : null;
    const sexMatch = document.querySelector('.participant-summary')?.textContent?.match(/Sexe : ([^\n]+)/);
    const sex = sexMatch ? sexMatch[1]?.trim() : null;
    currentParticipantInfo = prenom || age || sex ? { prenom, age, sex } : null;

    // Add export button
    resultsDiv.innerHTML += '<div style="text-align: center; margin-bottom: 20px;">' +
        '<button onclick="exportToPDF()" style="background-color: #2196F3; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">üìÑ Exporter en PDF</button>' +
        '</div>';

    // Recalculate excellent professions from stored responses
    const excellentProfessions = {};
    Object.keys(categories).forEach(category => {
        excellentProfessions[category] = [];
    });

    // Process responses to find ++ answers
    responses.forEach(response => {
        if (response.value === 4) { // ++ corresponds to value 4
            // Find the main category for this sub-dimension
            const mainCategory = Object.keys(categories).find(cat =>
                categories[cat].includes(response.dimension)
            );
            if (mainCategory && excellentProfessions[mainCategory]) {
                excellentProfessions[mainCategory].push(response.profession);
            }
        }
    });

    currentExcellentProfessions = excellentProfessions;

    // Display all categories in original order with main details only
    for (const [category, subcats] of Object.entries(categories)) {
        let profs = '';
        if (excellentProfessions[category] && excellentProfessions[category].length > 0) {
            profs = '<p>M√©tiers appr√©ci√©s : ' + excellentProfessions[category].join(', ') + '</p>';
        }
        resultsDiv.innerHTML += `
            <div class="category-results">
                <h3>${categoryEmojis[category]} ${category.toUpperCase()} (${percentages[category]}%) - ${descriptions[category]}</h3>
                ${profs}
            </div>
        `;
    }

    // Sort categories by percentage descending for top 3 summary
    const sortedCategories = Object.keys(percentages)
        .filter(key => key in descriptions)
        .sort((a, b) => percentages[b] - percentages[a])
        .slice(0, 3);

    const dominantProfile = sortedCategories.map(cat => cat.toUpperCase()).join(' ');
    resultsDiv.innerHTML += `<h3>Profil RIASEC dominant: ${dominantProfile}</h3>`;

    // Add radar chart
    resultsDiv.innerHTML += `
        <div class="radar-chart-container" style="text-align: center; margin: 20px 0;">
            <div style="position: relative; display: inline-block;">
                <img src="RIASEC Plan de travail 1.svg" alt="RIASEC Background" style="position: absolute; top: 0; left: 0; width: 400px; height: 400px; opacity: 0.5; z-index: 1; pointer-events: none;">
                <canvas id="riasecRadarChart" width="400" height="400" style="position: relative; z-index: 2;"></canvas>
            </div>
        </div>
    `;

    // Add combined exploration and accompaniment section
    resultsDiv.innerHTML += `
        <div class="exploration-section" style="background-color: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
            <h3 style="color: #495057; margin-bottom: 15px;">üîç Explorez vos formations et m√©tiers</h3>
            <p style="color: #6c757d; margin-bottom: 20px; line-height: 1.6;">
                Pour une interpr√©tation approfondie de vos r√©sultats et pour conna√Ætre les formations et m√©tiers associ√©s √† votre profil RIASEC, nous vous invitons √† vous faire accompagner par un psyEN.
                En attendant, vous pouvez explorer d√®s maintenant les formations et m√©tiers qui correspondent √† votre profil gr√¢ce √† nos moteurs de recherche sp√©cialis√©s.
            </p>
            <div class="search-buttons" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px;">
                <button onclick="openRIASECExplorer('bac')" style="background-color: #007bff; color: white; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; transition: background-color 0.3s;">
                    üéì Bac Pro & CAP - Acad√©mie de Paris
                </button>
                <button onclick="openRIASECExplorer('parcoursup')" style="background-color: #28a745; color: white; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; transition: background-color 0.3s;">
                    üéì Formations Sup√©rieures - Parcoursup
                </button>
                <button onclick="openRIASECExplorer('total')" style="background-color: #6f42c1; color: white; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; transition: background-color 0.3s;">
                    üìö Toutes les formations
                </button>
                <button onclick="openRIASECExplorer('metiers')" style="background-color: #fd7e14; color: white; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; transition: background-color 0.3s;">
                    üíº M√©tiers correspondants
                </button>
            </div>
        </div>
    `;

    // Create radar chart after DOM update
    setTimeout(() => {
        const ctx = document.getElementById('riasecRadarChart').getContext('2d');
        const riasecData = ['R', 'I', 'A', 'S', 'E', 'C'].map(cat => percentages[cat.toLowerCase()] || 0);

        new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['', '', '', '', '', ''],
                datasets: [{
                    data: riasecData,
                    borderColor: 'rgba(0, 0, 0, 1)',
                    backgroundColor: 'rgba(0, 0, 0, 0.1)',
                    borderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6,
                    pointBackgroundColor: 'rgba(0, 0, 0, 1)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgba(0, 0, 0, 1)'
                }]
            },
            options: {
                responsive: false, // Fixed size
                maintainAspectRatio: false,
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            stepSize: 20,
                            color: 'rgba(0, 0, 0, 0.8)',
                            font: {
                                size: 10
                            },
                            callback: function(value) {
                                return value + '%';
                            }
                        },
                        grid: {
                            color: 'rgba(0, 0, 0, 0.3)',
                            lineWidth: 1
                        },
                        angleLines: {
                            display: false // Hide angle lines from center to points
                        },
                        pointLabels: {
                            color: 'rgba(0, 0, 0, 0.8)',
                            font: {
                                size: 12,
                                weight: 'bold'
                            }
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        enabled: true,
                        callbacks: {
                            label: function(context) {
                                return context.label + ': ' + context.parsed.r + '%';
                            }
                        }
                    }
                },
                elements: {
                    line: {
                        tension: 0 // Straight lines between points
                    }
                }
            }
        });
    }, 100);
}

// Open RIASEC explorer with appropriate URL and parameters
function openRIASECExplorer(type) {
    if (!currentPercentages) {
        alert('Aucun r√©sultat disponible. Veuillez d\'abord passer le test.');
        return;
    }

    // Get the dominant profile (top 3 categories)
    const sortedCategories = Object.keys(currentPercentages)
        .filter(key => key in descriptions)
        .sort((a, b) => currentPercentages[b] - currentPercentages[a])
        .slice(0, 3);

    const dominantProfile = sortedCategories.join('').toUpperCase();

    let url;
    switch (type) {
        case 'bac':
            url = `https://vingtc.github.io/RIASEC/#${dominantProfile}`;
            break;
        case 'parcoursup':
            url = `https://vingtc.github.io/formationsup-RIASEC/#${dominantProfile}`;
            break;
        case 'total':
            url = `https://vingtc.github.io/RIASEC-tot/#${dominantProfile}`;
            break;
        case 'metiers':
            url = `https://vingtc.github.io/RIASEC-m-tiers/#${dominantProfile}`;
            break;
        default:
            return;
    }

    // Open in new tab
    window.open(url, '_blank');
}

// Hide submit button initially and add click listener to RIASEC image
document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('submit-btn').style.display = 'none';
    generateQuestions();
    document.getElementById('fill-random').addEventListener('click', fillRandom);
    document.getElementById('reset-btn').addEventListener('click', resetForm);
    document.getElementById('retrieve-btn').addEventListener('click', retrieveResults);

    // Show test button only when RIASEC image is clicked
    const riasecImage = document.querySelector('.riasec-image');
    if (riasecImage) {
        riasecImage.addEventListener('click', () => {
            document.getElementById('fill-random').style.display = 'block';
        });
    }
});
document.getElementById('submit-btn').addEventListener('click', handleSubmit);
